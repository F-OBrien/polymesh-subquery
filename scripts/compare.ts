import { Connection, createConnection, QueryBuilder } from "typeorm";
import { createWriteStream } from "fs";
import { env } from "process";
import expect from "expect";

require("dotenv").config(); // eslint-disable-line @typescript-eslint/no-var-requires

/**
 * This function runs the function `func` on pairs of items from `arr` returning the value
 * returned by `func` whenever it is not undefined
 */
const findInPairs = <T, K>(
  arr: T[],
  func: (a: T, b: T) => K | undefined
): K | undefined => {
  if (arr.length < 2) {
    return undefined;
  }
  for (let i = 0; i < arr.length - 1; i++) {
    const res = func(arr[i], arr[i + 1]);
    if (res !== undefined) {
      return res;
    }
  }
  return undefined;
};

// blocks in the data_block table known to have been generated wrong in the harvester.
const badDataBlocks = new Set([
  // These were reporting 0 events and 0 successful extrinsics when there were clearly events  in them.
  // https://app.polymesh.live/?rpc=wss%3A%2F%2Fitn-rpc.polymesh.live#/explorer/query/1900291
  // all of them contain only the TimestampSet and ExtrinsicSuccess events.
  1810441,
  1810936, 1811370, 1811478, 1811556, 1811690, 1812012, 1812141, 1812300,
  1812467, 1813102, 1813113, 1813686, 1814591, 1815254, 1815973, 1816475,
  1816484, 1816516, 1817204, 1818092, 1818676, 1819338, 1820002, 1820553,
  1820790, 1821000, 1821054, 1821121, 1821614, 1821816, 1821822, 1821952,
  1821992, 1822666, 1822726, 1823472, 1823861, 1824141, 1824166, 1824244,
  1824290, 1824341, 1824424, 1824446, 1824656, 1824760, 1824770, 1824808,
  1824830, 1824864, 1824895, 1824966, 1825049, 1825212, 1825256, 1825414,
  1825636, 1825677, 1825694, 1825768, 1825909, 1826091, 1826356, 1826361,
  1826415, 1826502, 1826581, 1826723, 1826825, 1827274, 1827344, 1827429,
  1827464, 1827517, 1827574, 1827615, 1827800, 1828632, 1828642, 1828698,
  1828998, 1829248, 1829711, 1829820, 1829939, 1830107, 1830192, 1830277,
  1830822, 1830842, 1830901, 1830920, 1830938, 1830999, 1831030, 1831163,
  1831164, 1831179, 1831223, 1831250, 1831319, 1831328, 1831369, 1831409,
  1831424, 1831647, 1831712, 1831867, 1831906, 1831932, 1831954, 1831963,
  1832020, 1832055, 1832069, 1832115, 1832139, 1832149, 1832161, 1832184,
  1832306, 1832333, 1832561, 1832688, 1832772, 1832793, 1832856, 1832869,
  1832906, 1832915, 1832941, 1832987, 1833116, 1833120, 1833241, 1833317,
  1833483, 1833499, 1833508, 1833517, 1833597, 1833618, 1833792, 1833884,
  1834055, 1834132, 1834201, 1834213, 1834227, 1834256, 1834290, 1834489,
  1834517, 1834527, 1834561, 1834571, 1834671, 1834755, 1834844, 1835043,
  1835073, 1835222, 1835291, 1835361, 1835495, 1835500, 1835602, 1835658,
  1835669, 1835670, 1835681, 1835731, 1835755, 1835804, 1835813, 1835832,
  1835888, 1835901, 1835927, 1835937, 1835975, 1837519, 1837539, 1837594,
  1837607, 1837646, 1838095, 1838205, 1838439, 1839338, 1842029, 1842036,
  1842072, 1842159, 1842281, 1842294, 1842499, 1842584, 1842652, 1842666,
  1842709, 1842740, 1842768, 1842783, 1842784, 1842808, 1842814, 1842938,
  1842989, 1842999, 1843009, 1843049, 1843069, 1843076, 1843144, 1843150,
  1843176, 1843177, 1843199, 1843201, 1843219, 1843247, 1843248, 1843344,
  1843369, 1843393, 1843442, 1843448, 1843499, 1843536, 1843580, 1843585,
  1843587, 1843592, 1843603, 1843608, 1843615, 1843616, 1843621, 1843627,
  1843632, 1843633, 1843635, 1843640, 1843641, 1843644, 1843645, 1843646,
  1843648, 1843651, 1843653, 1843654, 1843658, 1843660, 1843664, 1843665,
  1843666, 1843676, 1843677, 1843693, 1843694, 1843696, 1843701, 1843708,
  1843711, 1843720, 1843721, 1843725, 1843728, 1843732, 1843734, 1843742,
  1843743, 1843746, 1843753, 1843760, 1843762, 1843764, 1843768, 1843769,
  1843777, 1843779, 1843781, 1843791, 1843794, 1843795, 1843799, 1843800,
  1843802, 1843803, 1843806, 1843809, 1843811, 1843812, 1843816, 1843817,
  1843821, 1843822, 1843824, 1843825, 1843826, 1843829, 1843840, 1843842,
  1843847, 1843856, 1843871, 1843873, 1843877, 1843882, 1843892, 1843893,
  1843899, 1843905, 1843909, 1843913, 1843918, 1843919, 1843922, 1843923,
  1843926, 1843932, 1843934, 1843935, 1843945, 1843950, 1843953, 1843954,
  1843956, 1843960, 1843982, 1843993, 1843996, 1843999, 1844006, 1844015,
  1844021, 1844023, 1844024, 1844026, 1844027, 1844052, 1844057, 1844061,
  1844067, 1844075, 1844078, 1844083, 1844087, 1844091, 1844093, 1844094,
  1844095, 1844096, 1844100, 1844102, 1844103, 1844106, 1844109, 1844112,
  1844115, 1844117, 1844120, 1844129, 1844138, 1844141, 1844142, 1844144,
  1844146, 1844149, 1844155, 1844158, 1844161, 1844162, 1844176, 1844184,
  1844187, 1844188, 1844194, 1844199, 1844203, 1844208, 1844213, 1844220,
  1844221, 1844233, 1844239, 1844240, 1844241, 1844247, 1844258, 1844266,
  1844267, 1844276, 1844282, 1844284, 1844287, 1844294, 1844296, 1844324,
  1844331, 1844341, 1844353, 1844364, 1844366, 1844380, 1844389, 1844391,
  1844396, 1844399, 1844400, 1844403, 1844405, 1844413, 1844416, 1844417,
  1844419, 1844421, 1844426, 1844432, 1844441, 1844453, 1844457, 1844494,
  1844504, 1844510, 1844535, 1844580, 1844684, 1844692, 1844708, 1844768,
  1844769, 1844774, 1844786, 1844798, 1844848, 1844853, 1844924, 1844953,
  1844974, 1845096, 1845162, 1845217, 1845236, 1845297, 1845298, 1845328,
  1845369, 1845416, 1845517, 1845535, 1845569, 1845578, 1845678, 1845679,
  1845722, 1845731, 1845742, 1845790, 1845812, 1845814, 1845816, 1845832,
  1845838, 1845890, 1845933, 1845934, 1845952, 1846013, 1846024, 1846095,
  1846135, 1846209, 1846268, 1846383, 1846407, 1846421, 1846434, 1846440,
  1846442, 1846485, 1846538, 1846568, 1846615, 1846626, 1846654, 1846723,
  1846725, 1846736, 1846785, 1846792, 1846798, 1846828, 1846911, 1846916,
  1846920, 1846954, 1847267, 1851770, 1853306, 1856560, 1857874, 1858843,
  1862076, 1866430, 1867999, 1870625, 1871689, 1872721, 1875733, 1876039,
  1877112, 1877994, 1878136, 1880942, 1887033, 1891663, 1891667, 1891681,
  1891703, 1891779, 1891991, 1892061, 1892111, 1892151, 1892152, 1892181,
  1892563, 1893416, 1894739, 1895907, 1898781, 1900291, 2127625, 2127634,
  2127652, 2127663, 2127687, 2127712, 2127721, 2127736, 2127749, 2127778,
  2127779, 2127815, 2127839, 2127930, 2128020, 2128037, 2128049, 2128078,
  2128163, 2128173, 2128234, 2128265, 2128268, 2128276, 2128343, 2128389,
  2128428, 2128492, 2128540, 2128572, 2128624, 2128626, 2128643, 2128660,
  2128678, 2128704, 2128790, 2128795, 2128905, 2128920, 2128949, 2128957,
  2128964, 2128976, 2128987, 2129056, 2129114, 2129140, 2129167, 2129185,
  2129210, 2129219, 2129226, 2129240, 2129253, 2129255, 2129298, 2129312,
  2129317, 2129326, 2129354, 2129412, 2129422, 2129459, 2129538, 2129592,
  2129595, 2129596, 2129615, 2129622, 2129650, 2129680, 2129715, 2129753,
  2129758, 2129788, 2129795, 2129806, 2129852, 2129858, 2129862, 2129864,
  2129910, 2129924, 2129948, 2129994, 2130026, 2130064, 2130102, 2130122,
  2130141, 2130190, 2130205, 2130208, 2130313, 2130329, 2130333, 2130359,
  2130460, 2130463, 2130475, 2130508, 2130718, 2130768, 2130811, 2130812,
  2130861, 2130872, 2130893, 2130972, 2130973, 2130999, 2131010, 2131062,
  2131157, 2131211, 2131245, 2131251, 2131557, 2131567, 2131573, 2131584,
  2131633, 2131662, 2131719, 2131777, 2131808, 2131828, 2131849, 2131948,
  2132077, 2132155, 2132159, 2132181, 2132214, 2132295, 2132304, 2132418,
  2132487, 2132548, 2132549, 2132805, 2133040, 2133092, 2133237, 2133333,
  2133335, 2133339, 2133362, 2133364, 2133365, 2133373, 2133409, 2133445,
  2133631, 2133789, 2133876, 2133958, 2134154, 2134159, 2134287, 2134406,
  2134418, 2134496, 2134522, 2134614, 2134677, 2134716, 2134761, 2134861,
  2134885, 2134925, 2134962, 2135192, 2135263, 2135278, 2135363, 2135386,
  2135432, 2135617, 2135865, 2135931, 2135938, 2135997, 2136017, 2136296,
  2136439, 2136457, 2136652, 2136758, 2136782, 2136803, 2137038, 2137141,
  2137247, 2137327, 2137402, 2137474, 2137482, 2137495, 2137496, 2137543,
  2137598, 2137664, 2137691, 2137747, 2137936, 2137981, 2137988, 2138075,
  2138085, 2138184, 2138201, 2138342, 2138465, 2138605, 2138631, 2138652,
  2138661, 2138761, 2138903, 2139006, 2139258, 2139298, 2139419, 2139592,
  2139598, 2139662, 2139676, 2139797, 2139887, 2139902, 2140050, 2140104,
  2140294, 2140314, 2140317, 2140357, 2140412, 2140452, 2140468, 2140597,
  2140683, 2140760, 2140853, 2140878, 2140925, 2141248, 2141255, 2141300,
  2141348, 2141412, 2141561, 2141588, 2141645, 2141774, 2141794, 2141831,
  2141834, 2141850, 2141882, 2141949, 2142007, 2142048, 2142056, 2142126,
  2142331, 2142432, 2142489, 2142574, 2142643, 2142704, 2142749, 2142770,
  2142782, 2142825, 2142860, 2143132, 2143137, 2143172, 2143246, 2143252,
  2143363, 2143414, 2143431, 2143477, 2143568, 2143820, 2144256, 2144386,
  2144420, 2144448, 2144469, 2144484, 2144497, 2144621, 2144654, 2144791,
  2144792, 2144800, 2144818, 2144896, 2144960, 2144990, 2145057, 2145075,
  2145094, 2145297, 2145318, 2145340, 2145421, 2145485, 2145502, 2145565,
  2145703, 2145718, 2145746, 2145999, 2146113, 2146403, 2146414, 2146418,
  2146461, 2146526, 2146571, 2146687, 2146713, 2146744, 2146906, 2147035,
  2147046, 2147095, 2147239, 2147251, 2147415, 2147633, 2147670, 2147803,
  2147921, 2147987, 2148108, 2148146, 2148353, 2148382, 2148416, 2148436,
  2148560, 2148604, 2148648, 2148699, 2148773, 2148878, 2149123, 2149544,
  2149696, 2149954, 2150091, 2150124, 2150422, 2150675, 2150735, 2150739,
  2150985, 2151037, 2151196, 2151231, 2151334, 2151356, 2151459, 2151608,
  2151644, 2151687, 2151717, 2151989, 2152013, 2152142, 2152157, 2152211,
  2152251, 2152282, 2152313, 2152416, 2152576, 2152667, 2152683, 2152829,
  2153044, 2153058, 2153186, 2153329, 2153331, 2153392, 2153636, 2153645,
  2153672, 2153691, 2153708, 2153717, 2153756, 2153971, 2154056, 2154109,
  2154179, 2154184, 2154187, 2154195, 2154239, 2154347, 2154388, 2154515,
  2154677, 2154996, 2155010, 2155212, 2155249, 2155347, 2155513, 2155575,
  2155596, 2155669, 2155678, 2155776, 2155806, 2155945, 2155970, 2155983,
  2156146, 2156166, 2156230, 2156369, 2156374, 2156474, 2156642, 2156787,
  2156855, 2156909, 2156980, 2157280, 2157342, 2157508, 2157547, 2157566,
  2157817, 2157818, 2157939, 2157988, 2158133, 2158259, 2158344, 2158349,
  2158464, 2158535, 2158541, 2158652, 2158870, 2159000, 2159063, 2159149,
  2159164, 2159289, 2159316, 2159379, 2159394, 2159538, 2159731, 2159776,
  2159816, 2160028, 2160107, 2160172, 2160176, 2160192, 2160196, 2160220,
  2160245, 2160280, 2160302, 2160392, 2160422, 2160587, 2160697, 2160726,
  2160746, 2160782, 2160832, 2160836, 2160872, 2160916, 2161190, 2161466,
  2161475, 2161853, 2161862, 2162027, 2162802, 2162803, 2162850, 2162863,
  2163043, 2163051, 2163075, 2163134, 2163206, 2163274, 2163430, 2163493,
  2163507, 2163508, 2163552, 2163560, 2163717, 2163749, 2163752, 2163793,
  2163865, 2163952, 2164008, 2164039, 2164062, 2164078, 2164104, 2164193,
  2164209, 2164237, 2164424, 2164488, 2164636, 2164645, 2164672, 2164689,
  2164698, 2164712, 2164799, 2164816, 2165063, 2165138, 2165183, 2165191,
  2165212, 2165217, 2165348, 2165917, 2166043, 2166284, 2166491, 2166631,
  2166634, 2166725, 2167299, 2168154, 2171605, 2173393, 2175965, 2176531,
  2180000, 2182596, 2182762, 2186047, 2186149, 2188156, 2188983, 2191048,
  2191785, 2192911, 2193865, 2194057, 2194914, 2198599, 2199728, 2206193,
  2206501, 2206828, 2207203, 2207221, 2207239, 2209142, 2209273, 2209373,
  2209438, 2209467, 2209523, 2209599, 2209602, 2209662, 2209690, 2209704,
  2209754, 2209800, 2209853, 2209892, 2209944, 2209954, 2210014, 2210057,
  2210068, 2210080, 2210100, 2210122, 2210164, 2210203, 2210208, 2210256,
  2210266, 2210294, 2210337, 2210389, 2210398, 2210409, 2210431, 2210445,
  2210457, 2210464, 2210490, 2210492, 2210520, 2210567, 2210623, 2210634,
  2210680, 2210691, 2210742, 2210753, 2210756, 2210771, 2210774, 2210785,
  2210822, 2210910, 2210954, 2210963, 2211030, 2211077, 2211154, 2211168,
  2211190, 2211195, 2211201, 2211214, 2211229, 2211247, 2211286, 2211292,
  2211349, 2211432, 2211436, 2211456, 2211493, 2211522, 2211528, 2211561,
  2211578, 2211605, 2211694, 2211724, 2211732, 2211778, 2211788, 2211872,
  2211885, 2211943, 2211969, 2211974, 2211986, 2211991, 2212025, 2212026,
  2212035, 2212036, 2212037, 2212054, 2212093, 2212095, 2212151, 2212185,
  2212237, 2212241, 2212242, 2212268, 2212275, 2212283, 2212294, 2212310,
  2212333, 2212335, 2212385, 2212388, 2212450, 2212483, 2212502, 2212517,
  2212525, 2212551, 2212554, 2212577, 2212582, 2212585, 2212589, 2212611,
  2212612, 2212617, 2212624, 2212703, 2212709, 2212719, 2212723, 2212784,
  2212791, 2212821, 2212822, 2212832, 2212844, 2212852, 2212879, 2212888,
  2212889, 2212907, 2212909, 2212936, 2212952, 2212989, 2213003, 2213005,
  2213041, 2213054, 2213074, 2213086, 2213087, 2213110, 2213125, 2213164,
  2213185, 2213194, 2213222, 2213279, 2213352, 2213355, 2213363, 2213366,
  2213379, 2213388, 2213406, 2213407, 2213413, 2213416, 2213452, 2213459,
  2213467, 2213488, 2213520, 2213552, 2213595, 2213603, 2213626, 2213707,
  2213742, 2213767, 2213825, 2213861, 2213903, 2213904, 2213923, 2213941,
  2213978, 2214000, 2214030, 2214109, 2214120, 2214132, 2214165, 2214166,
  2214229, 2214232, 2214269, 2214282, 2214288, 2214297, 2214349, 2214364,
  2214408, 2214440, 2214447, 2214469, 2214483, 2214488, 2214513, 2214532,
  2214620, 2214650, 2214664, 2214687, 2214690, 2214722, 2214732, 2214745,
  2214760, 2214786, 2214822, 2214849, 2214862, 2214874, 2214892, 2214915,
  2214935, 2214944, 2214957, 2214974, 2215058, 2215073, 2215136, 2215183,
  2215190, 2215226, 2215256, 2215327, 2215500, 2215526, 2215610, 2215621,
  2215646, 2215699, 2215719, 2215757, 2215758, 2215762, 2215785, 2215942,
  2215976, 2215979, 2215984, 2215992, 2215994, 2216066, 2216078, 2216136,
  2216138, 2216152, 2216177, 2216248, 2216265, 2216275, 2216276, 2216290,
  2216347, 2216348, 2216372, 2216390, 2216408, 2216416, 2216433, 2216434,
  2216451, 2216458, 2216460, 2216544, 2216561, 2216624, 2216639, 2216647,
  2216650, 2216654, 2216706, 2216721, 2216728, 2216731, 2216732, 2216750,
  2216751, 2216755, 2216761, 2216762, 2216770, 2216771, 2216773, 2216793,
  2216824, 2216848, 2216894, 2216896, 2216945, 2216961, 2216981, 2216988,
  2217009, 2217032, 2217041, 2217073, 2217088, 2217096, 2217101, 2217116,
  2217162, 2217171, 2217258, 2217291, 2217296, 2217299, 2217306, 2217319,
  2217355, 2217377, 2217422, 2217428, 2217460, 2217600, 2217649, 2217663,
  2217673, 2217682, 2217696, 2217725, 2217726, 2217787, 2217805, 2217819,
  2217855, 2217911, 2217947, 2217958, 2217975, 2217979, 2218011, 2218021,
  2218033, 2218077, 2218114, 2218186, 2218211, 2218258, 2218277, 2218282,
  2218288, 2218304, 2218307, 2218330, 2218368, 2218412, 2218519, 2218524,
  2218605, 2218611, 2218689, 2218698, 2218971, 2218994, 2219088, 2219098,
  2219170, 2219213, 2219239, 2219283, 2219342, 2219418, 2219481, 2219524,
  2219549, 2219691, 2219755, 2219808, 2219856, 2219923, 2219924, 2219963,
  2220009, 2220028, 2220031, 2220059, 2220076, 2220136, 2220158, 2220160,
  2220178, 2220189, 2220208, 2220251, 2220319, 2220344, 2220392, 2220423,
  2220489, 2220506, 2220557, 2220572, 2220647, 2220679, 2220689, 2220734,
  2220850, 2220871, 2220879, 2220886, 2220961, 2221026, 2221095, 2221166,
  2221188, 2221261, 2221269, 2221270, 2221278, 2221287, 2221295, 2221309,
  2221377, 2221399, 2221463, 2221480, 2221538, 2221557, 2221624, 2221686,
  2221715, 2221862, 2221885, 2221973, 2221996, 2222000, 2222024, 2222026,
  2222069, 2222075, 2222109, 2222147, 2222176, 2222184, 2222197, 2222214,
  2222264, 2222304, 2222305, 2222312, 2222393, 2222429, 2222445, 2222488,
  2222496, 2222521, 2222652, 2222679, 2222706, 2222713, 2222819, 2222826,
  2222902, 2222953, 2222976, 2223206, 2223223, 2223375, 2223387, 2223430,
  2223431, 2223530, 2223537, 2223543, 2223595, 2223629, 2223656, 2223674,
  2223675, 2223687, 2223719, 2223764, 2223769, 2223787, 2223821, 2223829,
  2223831, 2223845, 2223899, 2223926, 2223944, 2223975, 2223976, 2224052,
  2224064, 2224076, 2224112, 2224254, 2224316, 2224329, 2224347, 2224365,
  2224398, 2224407, 2224436, 2224450, 2224471, 2224474, 2224654, 2224656,
  2224666, 2224669, 2224679, 2224862, 2224920, 2225080, 2225189, 2225222,
  2225223, 2225227, 2225374, 2225410, 2225426, 2225451, 2225477, 2225479,
  2225525, 2225526, 2225558, 2225575, 2225675, 2225705, 2226214, 2226544,
  2226547, 2226559, 2226574, 2226583, 2226641, 2226653, 2226715, 2226959,
  2227024, 2227515, 2227766, 2227811, 2227815, 2227835, 2227843, 2227913,
  2227933, 2227941, 2228060, 2228090, 2228140, 2228200, 2228209, 2228259,
  2228469, 2228742, 2228755, 2228801, 2228853, 2228865, 2228880, 2228900,
  2228945, 2229002, 2229023, 2229044, 2229125, 2229187, 2229287, 2229361,
  2229382, 2229386, 2229399, 2229447, 2229588, 2229615, 2229678, 2231593,
  2232036, 2233776, 2242707, 2243665, 2244443, 2244964, 2247956, 2250590,
  2251315, 2251543, 2252898, 2253027, 2253094, 2253122, 2253239, 2253459,
  2253592, 2253734, 2253925, 2253928, 2253930, 2253939, 2254016, 2254074,
  2254080, 2254111, 2254122, 2254123, 2254151, 2254175, 2254400, 2254402,
  2254543, 2254544, 2254614, 2254723, 2254754, 2254857, 2254861, 2254892,
  2255174, 2255179, 2255314, 2255512, 2255705, 2255848, 2255898, 2256027,
  2256031, 2256162, 2256181, 2256285, 2256298, 2256374, 2256416, 2256471,
  2256519, 2256546, 2256567, 2256614, 2256637, 2256662, 2256850, 2256877,
  2256899, 2256924, 2256937, 2256981, 2256984, 2257025, 2257058, 2257175,
  2257185, 2257186, 2257188, 2257267, 2257288, 2257290, 2257304, 2257325,
  2257351, 2257367, 2257398, 2257473, 2257525, 2257641, 2257646, 2257661,
  2257709, 2257752, 2257757, 2257779, 2257787, 2257798, 2257803, 2257819,
  2257849, 2257862, 2257867, 2257873, 2257943, 2257971, 2258107, 2258114,
  2258189, 2258193, 2258230, 2258255, 2258278, 2258291, 2258293, 2258338,
  2258339, 2258344, 2258360, 2258377, 2258383, 2258411, 2258473, 2258485,
  2258526, 2258553, 2258581, 2258626, 2258699, 2258714, 2258726, 2258737,
  2258785, 2258857, 2258867, 2258881, 2258898, 2258918, 2258919, 2259065,
  2259069, 2259109, 2259120, 2259126, 2259155, 2259182, 2259211, 2259218,
  2259231, 2259306, 2259309, 2259315, 2259324, 2259354, 2259356, 2259427,
  2259557, 2259558, 2259562, 2259708, 2259728, 2259746, 2259795, 2259798,
  2259810, 2259817, 2259820, 2259825, 2259826, 2259858, 2259887, 2259900,
  2259903, 2259927, 2259958, 2260011, 2260013, 2260035, 2260038, 2260040,
  2260086, 2260124, 2260132, 2260133, 2260135, 2260173, 2260197, 2260198,
  2260224, 2260229, 2260275, 2260310, 2260312, 2260330, 2260378, 2260396,
  2260460, 2260483, 2260497, 2260503, 2260513, 2260556, 2260578, 2260579,
  2260592, 2260610, 2260616, 2260645, 2260649, 2260650, 2260656, 2260663,
  2260766, 2260782, 2260788, 2260827, 2260840, 2260857, 2260942, 2261003,
  2261010, 2261036, 2261090, 2261162, 2261173, 2261177, 2261245, 2261279,
  2261380, 2261382, 2261384, 2261512, 2261513, 2261526, 2261569, 2261584,
  2261602, 2261626, 2261640, 2261644, 2261656, 2261664, 2261669, 2261674,
  2261693, 2261694, 2261733, 2261752, 2261785, 2261853, 2261860, 2261873,
  2261898, 2261902, 2261914, 2261933, 2261936, 2261956, 2261960, 2261975,
  2262016, 2262046, 2262076, 2262097, 2262114, 2262126, 2262130, 2262158,
  2262164, 2262182, 2262186, 2262227, 2262243, 2262244, 2262263, 2262279,
  2262288, 2262306, 2262315, 2262360, 2262386, 2262396, 2262499, 2262524,
  2262586, 2262621, 2262631, 2262659, 2262664, 2262674, 2262680, 2262689,
  2262691, 2262718, 2262719, 2262788, 2262798, 2262819, 2262903, 2262920,
  2262989, 2262994, 2263015, 2263025, 2263033, 2263075, 2263114, 2263162,
  2263262, 2263274, 2263302, 2263353, 2263361, 2263364, 2263367, 2263409,
  2263512, 2263534, 2263569, 2263606, 2263627, 2263646, 2263705, 2263755,
  2263788, 2263819, 2263884, 2263894, 2263918, 2263976, 2263996, 2264001,
  2264056, 2264099, 2264151, 2264196, 2264198, 2264234, 2264258, 2264390,
  2264419, 2264421, 2264428, 2264432, 2264436, 2264461, 2264577, 2264591,
  2264612, 2264613, 2264679, 2264686, 2264735, 2264783, 2264834, 2264872,
  2264882, 2264920, 2264935, 2264963, 2264966, 2264969, 2264991, 2264999,
  2265000, 2265031, 2265036, 2265039, 2265048, 2265076, 2265099, 2265132,
  2265174, 2265199, 2265245, 2265326, 2265367, 2265443, 2265484, 2265539,
  2265581, 2265590, 2265591, 2265611, 2265612, 2265733, 2265768, 2265771,
  2265875, 2265910, 2265949, 2265952, 2266015, 2266043, 2266073, 2266078,
  2266140, 2266142, 2266147, 2266188, 2266223, 2266229, 2266241, 2266287,
  2266313, 2266316, 2266317, 2266318, 2266334, 2266345, 2266368, 2266396,
  2266439, 2266471, 2266493, 2266554, 2266607, 2266634, 2266688, 2266719,
  2266754, 2266764, 2266790, 2266795, 2266802, 2266830, 2266885, 2266892,
  2266903, 2266905, 2266952, 2266967, 2267009, 2267013, 2267016, 2267036,
  2267109, 2267130, 2267203, 2267252, 2267306, 2267349, 2267352, 2267395,
  2267400, 2267419, 2267424, 2267441, 2267507, 2267521, 2267547, 2267557,
  2267683, 2267688, 2267691, 2267712, 2267741, 2267750, 2267781, 2267819,
  2267951, 2267999, 2268057, 2268061, 2268082, 2268100, 2268112, 2268121,
  2268264, 2268313, 2268330, 2268346, 2268422, 2268529, 2268533, 2268626,
  2268646, 2268711, 2268726, 2268731, 2268764, 2268773, 2268829, 2268843,
  2268883, 2269001, 2269016, 2269118, 2269142, 2269182, 2269246, 2269259,
  2269261, 2269274, 2269276, 2269283, 2269306, 2269321, 2269327, 2269338,
  2269350, 2269389, 2269394, 2269447, 2269456, 2269529, 2269531, 2269560,
  2269618, 2269632, 2269665, 2269673, 2269689, 2269699, 2269727, 2269742,
  2269746, 2269751, 2269858, 2269874, 2269875, 2269938, 2269949, 2269961,
  2269971, 2269973, 2269994, 2269995, 2269999, 2270012, 2270014, 2270097,
  2270173, 2270211, 2270213, 2270214, 2270223, 2270258, 2270274, 2270277,
  2270280, 2270320, 2270321, 2270322, 2270330, 2270341, 2270373, 2270376,
  2270398, 2270407, 2270421, 2270423, 2270432, 2270467, 2270470, 2270478,
  2270482, 2270497, 2270522, 2270534, 2270559, 2270567, 2270628, 2270652,
  2270684, 2270715, 2270744, 2270786, 2270809, 2270813, 2270850, 2270856,
  2270868, 2270922, 2270939, 2270951, 2270955, 2270981, 2270986, 2271002,
  2271004, 2271035, 2271047, 2271048, 2271059, 2271061, 2271064, 2271108,
  2271128, 2271159, 2271168, 2271175, 2271195, 2271206, 2271245, 2271254,
  2271276, 2271325, 2271344, 2271347, 2271373, 2271396, 2271405, 2271406,
  2271450, 2271483, 2271594, 2271630, 2271648, 2271660, 2271669, 2271727,
  2271795, 2271811, 2271822, 2271847, 2271874, 2271902, 2271910, 2271922,
  2271968, 2272022, 2272023, 2272031, 2272053, 2272060, 2272218, 2272243,
  2272246, 2272254, 2272330, 2272430, 2272451, 2272455, 2272463, 2272473,
  2272481, 2272505, 2272509, 2272510, 2272566, 2272581, 2272624, 2272652,
  2272659, 2272671, 2272785, 2272812, 2272846, 2272858, 2272866, 2272871,
  2272975, 2273092, 2273338, 2273380, 2273471, 2273697, 2273709, 2273960,
  2274002, 2274036, 2274065, 2274150, 2274153, 2274198, 2274272, 2274457,
  2274482, 2274614, 2274670, 2274693, 2274796, 2275379, 2275538, 2275915,
  2275927, 2276053, 2276068, 2276084, 2276089, 2276185, 2276221, 2276232,
  2276233, 2276334, 2276344, 2276377, 2276417, 2276418, 2276454, 2276464,
  2276465, 2276557, 2276720, 2276772, 2276832, 2276862, 2276877, 2276923,
  2276992, 2277083, 2277089, 2277106, 2277107, 2277164, 2277168, 2277182,
  2277217, 2277222, 2277315, 2277332, 2277416, 2277459, 2277467, 2277485,
  2277582, 2277607, 2277797, 2277875, 2277940, 2277944, 2277950, 2277953,
  2277956, 2277957, 2277975, 2277987, 2277988, 2277992, 2277993, 2277995,
  2278000, 2278001, 2278005, 2278014, 2278028, 2278030, 2278032, 2278035,
  2278037, 2278038, 2278040, 2278043, 2278052, 2278058, 2278059, 2278064,
  2278065, 2278074, 2278076, 2278079, 2278084, 2278091, 2278099, 2278102,
  2278107, 2278110, 2278112, 2278127, 2278131, 2278135, 2278140, 2278145,
  2278154, 2278170, 2278178, 2278179, 2278187, 2278190, 2278198, 2278204,
  2278210, 2278219, 2278222, 2278226, 2278232, 2278239, 2278256, 2278257,
  2278258, 2278261, 2278264, 2278267, 2278268, 2278286, 2278290, 2278291,
  2278300, 2278302, 2278304, 2278305, 2278307, 2278321, 2278324, 2278330,
  2278332, 2278335, 2278338, 2278340, 2278341, 2278342, 2278345, 2278348,
  2278353, 2278355, 2278363, 2278372, 2278378, 2278379, 2278380, 2278389,
  2278398, 2278400, 2278407, 2278408, 2278414, 2278422, 2278427, 2278428,
  2278431, 2278436, 2278438, 2278444, 2278447, 2278448, 2278453, 2278455,
  2278457, 2278460, 2278465, 2278478, 2278483, 2278487, 2278496, 2278500,
  2278501, 2278506, 2278507, 2278524, 2278527, 2278535, 2278536, 2278537,
  2278540, 2278543, 2278545, 2278546, 2278552, 2278555, 2278556, 2278563,
  2278569, 2278576, 2278583, 2278584, 2278585, 2278597, 2278605, 2278618,
  2278623, 2278636, 2278638, 2278640, 2278642, 2278644, 2278645, 2278646,
  2278658, 2278677, 2278681, 2278689, 2278698, 2278712, 2278714, 2278723,
  2278741, 2278751, 2278754, 2278764, 2278766, 2278767, 2278769, 2278773,
  2278784, 2278786, 2278800, 2278806, 2278807, 2278808, 2278809, 2278824,
  2278843, 2278853, 2278856, 2278859, 2278861, 2278870, 2278871, 2278886,
  2278890, 2278898, 2278902, 2278904, 2278907, 2278909, 2278911, 2278913,
  2278917, 2278923, 2278935, 2278941, 2278945, 2278953, 2278955, 2278959,
  2278962, 2278965, 2278966, 2278984, 2278991, 2278999, 2279007, 2279008,
  2279019, 2279022, 2279040, 2279043, 2279049, 2279051, 2279054, 2279057,
  2279063, 2279068, 2279070, 2279080, 2279095, 2279101, 2279104, 2279112,
  2279120, 2279128, 2279133, 2279149, 2279150, 2279161, 2279169, 2279171,
  2279174, 2279177, 2279182, 2279184, 2279187, 2279193, 2279196, 2279200,
  2279204, 2279220, 2279221, 2279222, 2279227, 2279229, 2279235, 2279238,
  2279242, 2279243, 2279246, 2279247, 2279248, 2279249, 2279257, 2279261,
  2279267, 2279274, 2279285, 2279288, 2279293, 2279309, 2279310, 2279317,
  2279321, 2279322, 2279334, 2279335, 2279346, 2279354, 2279364, 2279367,
  2279371, 2279374, 2279378, 2279379, 2279380, 2279394, 2279396, 2279398,
  2279409, 2279415, 2279416, 2279418, 2279420, 2279425, 2279434, 2279437,
  2279447, 2279449, 2279452, 2279465, 2279475, 2279479, 2279482, 2279483,
  2279487, 2279491, 2279502, 2279504, 2279506, 2279515, 2279517, 2279528,
  2279530, 2279537, 2279540, 2279541, 2279547, 2279548, 2279551, 2279555,
  2279566, 2279570, 2279577, 2279582, 2279584, 2279589, 2279590, 2279593,
  2279598, 2279602, 2279622, 2279634, 2279636, 2279643, 2279644, 2279645,
  2279651, 2279667, 2279669, 2279672, 2279677, 2279682, 2279683, 2279687,
  2279692, 2279694, 2279710, 2279716, 2279718, 2279726, 2279728, 2279731,
  2279734, 2279735, 2279742, 2279745, 2279764, 2279768, 2279771, 2279790,
  2279792, 2279799, 2279804, 2279807, 2279818, 2279820, 2279827, 2279833,
  2279839, 2279846, 2279870, 2279871, 2279875, 2279877, 2279883, 2279892,
  2279894, 2279895, 2279922, 2279929, 2279939, 2279941, 2279942, 2279944,
  2279951, 2279959, 2279964, 2279969, 2279986, 2279990, 2280004, 2280034,
  2280035, 2280040, 2280047, 2280048, 2280059, 2280060, 2280061, 2280062,
  2280063, 2280065, 2280073, 2280076, 2280080, 2280084, 2280091, 2280097,
  2280100, 2280101, 2280107, 2280112, 2280117, 2280120, 2280123, 2280125,
  2280126, 2280128, 2280134, 2280136, 2280144, 2280152, 2280155, 2280160,
  2280162, 2280163, 2280166, 2280169, 2280175, 2280176, 2280190, 2280191,
  2280192, 2280198, 2280201, 2280203, 2280207, 2280210, 2280213, 2280217,
  2280218, 2280229, 2280234, 2280237, 2280263, 2280266, 2280281, 2280283,
  2280284, 2280296, 2280301, 2280302, 2280316, 2280323, 2280327, 2280332,
  2280360, 2280390, 2280396, 2280398, 2280399, 2280406, 2280419, 2280434,
  2280443, 2280445, 2280453, 2280458, 2280462, 2280466, 2280473, 2280480,
  2280485, 2280487, 2280488, 2280493, 2280494, 2280514, 2280531, 2280543,
  2280554, 2280556, 2280565, 2280576, 2280590, 2280593, 2280595, 2280600,
  2280601, 2280605, 2280607, 2280613, 2280623, 2280626, 2280646, 2280650,
  2280658, 2280659, 2280665, 2280666, 2280668, 2280675, 2280680, 2280685,
  2280698, 2280701, 2280716, 2280728, 2280730, 2280733, 2280743, 2280746,
  2280753, 2280772, 2280779, 2280785, 2280800, 2280808, 2280812, 2280825,
  2280829, 2280852, 2280859, 2280861, 2280863, 2280868, 2280879, 2280880,
  2280884, 2280885, 2280887, 2280891, 2280896, 2280902, 2280912, 2280933,
  2280937, 2280941, 2280943, 2280944, 2280946, 2280951, 2280960, 2280962,
  2280968, 2280970, 2280975, 2280977, 2280987, 2280989, 2281001, 2281013,
  2281022, 2281023, 2281024, 2281026, 2281037, 2281041, 2281042, 2281046,
  2281048, 2281059, 2281067, 2281074, 2281079, 2281083, 2281110, 2281116,
  2281124, 2281126, 2281130, 2281133, 2281136, 2281138, 2281146, 2281147,
  2281160, 2281162, 2281171, 2281172, 2281176, 2281184, 2281189, 2281190,
  2281199, 2281203, 2281204, 2281211, 2281213, 2281215, 2281220, 2281223,
  2281225, 2281226, 2281229, 2281240, 2281241, 2281253, 2281264, 2281265,
  2281267, 2281269, 2281273, 2281275, 2281277, 2281286, 2281287, 2281289,
  2281305, 2281311, 2281314, 2281318, 2281319, 2281320, 2281325, 2281343,
  2281353, 2281358, 2281359, 2281370, 2281383, 2281388, 2281390, 2281393,
  2281395, 2281402, 2281404, 2281406, 2281407, 2281410, 2281411, 2281412,
  2281422, 2281426, 2281430, 2281439, 2281442, 2281444, 2281445, 2281448,
  2281449, 2281474, 2281482, 2281499, 2281501, 2281503, 2281505, 2281513,
  2281517, 2281521, 2281523, 2281531, 2281537, 2281551, 2281553, 2281559,
  2281562, 2281573, 2281582, 2281586, 2281595, 2281601, 2281621, 2281626,
  2281629, 2281635, 2281636, 2281638, 2281644, 2281657, 2281669, 2281672,
  2281677, 2281679, 2281681, 2281686, 2281687, 2281688, 2281689, 2281691,
  2281695, 2281699, 2281704, 2281716, 2281722, 2281730, 2281732, 2281735,
  2281737, 2281771, 2281773, 2281777, 2281782, 2281796, 2281797, 2281798,
  2281800, 2281804, 2281805, 2281806, 2281808, 2281809, 2281817, 2281819,
  2281825, 2281829, 2281831, 2281851, 2281853, 2281856, 2281860, 2281873,
  2281878, 2281887, 2281894, 2281931, 2281935, 2281943, 2281944, 2281958,
  2281960, 2281963, 2281965, 2281985, 2281988, 2281992, 2281993, 2281996,
  2282007, 2282022, 2282036, 2282058, 2282080, 2282083, 2282090, 2282095,
  2282099, 2282123, 2282124, 2282125, 2282129, 2282130, 2282139, 2282140,
  2282144, 2282153, 2282157, 2282165, 2282169, 2282171, 2282172, 2282176,
  2282213, 2282217, 2282218, 2282238, 2282243, 2282246, 2282248, 2282252,
  2282257, 2282266, 2282277, 2282284, 2282288, 2282291, 2282299, 2282300,
  2282302, 2282319, 2282320, 2282335, 2282339, 2282343, 2282351, 2282355,
  2282362, 2282365, 2282370, 2282372, 2282377, 2282392, 2282397, 2282406,
  2282412, 2282417, 2282430, 2282443, 2282460, 2282470, 2282474, 2282476,
  2282483, 2282494, 2282503, 2282509, 2282514, 2282516, 2282519, 2282530,
  2282533, 2282539, 2282540, 2282542, 2282547, 2282550, 2282563, 2282567,
  2282569, 2282573, 2282587, 2282594, 2282603, 2282605, 2282608, 2282617,
  2282622, 2282629, 2282633, 2282636, 2282638, 2282646, 2282667, 2282668,
  2282671, 2282676, 2282677, 2282682, 2282684, 2282688, 2282695, 2282698,
  2282700, 2282703, 2282704, 2282708, 2282710, 2282712, 2282718, 2282720,
  2282722, 2282733, 2282740, 2282745, 2282763, 2282766, 2282792, 2282793,
  2282800, 2282804, 2282808, 2282812, 2282815, 2282836, 2282840, 2282844,
  2282851, 2282854, 2282864, 2282868, 2282872, 2282877, 2282883, 2282890,
  2282899, 2282904, 2282905, 2282908, 2282910, 2282911, 2282916, 2282930,
  2282941, 2282946, 2282960, 2282971, 2282973, 2282975, 2282986, 2282987,
  2282991, 2283000, 2283002, 2283003, 2283008, 2283009, 2283013, 2283018,
  2283025, 2283027, 2283039, 2283048, 2283050, 2283056, 2283059, 2283062,
  2283067, 2283070, 2283072, 2283086, 2283087, 2283091, 2283101, 2283108,
  2283134, 2283144, 2283164, 2283169, 2283172, 2283184, 2283186, 2283190,
  2283192, 2283198, 2283210, 2283222, 2283226, 2283227, 2283232, 2283249,
  2283258, 2283259, 2283260, 2283266, 2283283, 2283300, 2283302, 2283308,
  2283315, 2283323, 2283328, 2283330, 2283334, 2283336, 2283371, 2283376,
  2283377, 2283380, 2283383, 2283384, 2283386, 2283390, 2283392, 2283396,
  2283397, 2283403, 2283408, 2283416, 2283417, 2283420, 2283421, 2283425,
  2283429, 2283433, 2283441, 2283444, 2283448, 2283458, 2283466, 2283469,
  2283475, 2283481, 2283482, 2283484, 2283505, 2283513, 2283522, 2283527,
  2283533, 2283535, 2283548, 2283550, 2283559, 2283569, 2283577, 2283578,
  2283589, 2283592, 2283618, 2283619, 2283632, 2283636, 2283643, 2283648,
  2283660, 2283665, 2283666, 2283667, 2283684, 2283694, 2283699, 2283701,
  2283702, 2283705, 2283706, 2283713, 2283715, 2283716, 2283722, 2283727,
  2283729, 2283745, 2283756, 2283760, 2283767, 2283769, 2283772, 2283773,
  2283774, 2283783, 2283793, 2283799, 2283803, 2283814, 2283820, 2283825,
  2283828, 2283834, 2283835, 2283842, 2283850, 2283852, 2283856, 2283858,
  2283860, 2283862, 2283865, 2283878, 2283880, 2283882, 2283893, 2283900,
  2283902, 2283913, 2283914, 2283915, 2283921, 2283927, 2283936, 2283946,
  2283972, 2283977, 2283987, 2283989, 2284002, 2284006, 2284008, 2284011,
  2284018, 2284036, 2284055, 2284067, 2284070, 2284075, 2284083, 2284085,
  2284097, 2284103, 2284115, 2284116, 2284118, 2284121, 2284125, 2284136,
  2284140, 2284143, 2284152, 2284176, 2284177, 2284186, 2284193, 2284196,
  2284200, 2284219, 2284221, 2284223, 2284228, 2284231, 2284234, 2284235,
  2284237, 2284238, 2284245, 2284247, 2284250, 2284253, 2284260, 2284262,
  2284265, 2284268, 2284286, 2284288, 2284290, 2284300, 2284304, 2284305,
  2284316, 2284317, 2284318, 2284319, 2284321, 2284336, 2284337, 2284345,
  2284349, 2284354, 2284356, 2284358, 2284363, 2284365, 2284368, 2284377,
  2284384, 2284385, 2284390, 2284398, 2284402, 2284406, 2284411, 2284426,
  2284433, 2284442, 2284443, 2284451, 2284452, 2284455, 2284462, 2284466,
  2284468, 2284470, 2284472, 2284474, 2284477, 2284482, 2284484, 2284487,
  2284493, 2284499, 2284512, 2284517, 2284526, 2284528, 2284532, 2284534,
  2284538, 2284545, 2284547, 2284550, 2284558, 2284561, 2284562, 2284584,
  2284589, 2284590, 2284599, 2284600, 2284602, 2284608, 2284613, 2284628,
  2284634, 2284637, 2284645, 2284654, 2284656, 2284660, 2284687, 2284696,
  2284714, 2284722, 2284724, 2284732, 2284734, 2284736, 2284738, 2284748,
  2284751, 2284754, 2284756, 2284758, 2284763, 2284770, 2284776, 2284782,
  2284783, 2284788, 2284799, 2284802, 2284810, 2284822, 2284827, 2284829,
  2284832, 2284854, 2284858, 2284869, 2284873, 2284879, 2284886, 2284889,
  2284891, 2284898, 2284902, 2284909, 2284910, 2284922, 2284932, 2284959,
  2284963, 2284968, 2284983, 2284984, 2284985, 2284990, 2285000, 2285001,
  2285008, 2285011, 2285020, 2285026, 2285028, 2285033, 2285037, 2285043,
  2285055, 2285084, 2285087, 2285088, 2285090, 2285097, 2285109, 2285125,
  2285128, 2285131, 2285134, 2285138, 2285140, 2285144, 2285148, 2285156,
  2285162, 2285163, 2285171, 2285175, 2285177, 2285187, 2285192, 2285193,
  2285201, 2285202, 2285206, 2285208, 2285239, 2285240, 2285244, 2285249,
  2285255, 2285256, 2285260, 2285261, 2285262, 2285263, 2285265, 2285278,
  2285282, 2285283, 2285284, 2285289, 2285291, 2285293, 2285298, 2285302,
  2285310, 2285312, 2285315, 2285320, 2285328, 2285331, 2285341, 2285343,
  2285345, 2285346, 2285353, 2285364, 2285367, 2285378, 2285382, 2285385,
  2285392, 2285393, 2285395, 2285397, 2285401, 2285406, 2285411, 2285419,
  2285423, 2285434, 2285435, 2285440, 2285451, 2285456, 2285477, 2285479,
  2285491, 2285494, 2285499, 2285503, 2285506, 2285514, 2285528, 2285538,
  2285548, 2285555, 2285556, 2285558, 2285561, 2285566, 2285570, 2285576,
  2285578, 2285590, 2285602, 2285604, 2285608, 2285615, 2285616, 2285623,
  2285628, 2285638, 2285643, 2285646, 2285649, 2285650, 2285661, 2285668,
  2285670, 2285680, 2285688, 2285691, 2285692, 2285706, 2285712, 2285716,
  2285719, 2285724, 2285729, 2285740, 2285743, 2285746, 2285757, 2285760,
  2285766, 2285769, 2285779, 2285781, 2285786, 2285791, 2285804, 2285809,
  2285813, 2285814, 2285823, 2285830, 2285832, 2285854, 2285858, 2285861,
  2285873, 2285876, 2285877, 2285883, 2285886, 2285887, 2285903, 2285907,
  2285911, 2285912, 2285913, 2285915, 2285921, 2285924, 2285926, 2285937,
  2285941, 2285948, 2285961, 2285967, 2285981, 2286008, 2286012, 2286018,
  2286021, 2286024, 2286031, 2286034, 2286035, 2286061, 2286062, 2286065,
  2286069, 2286074, 2286076, 2286077, 2286082, 2286084, 2286086, 2286094,
  2286099, 2286100, 2286105, 2286115, 2286118, 2286122, 2286124, 2286140,
  2286147, 2286148, 2286151, 2286157, 2286168, 2286174, 2286181, 2286182,
  2286185, 2286191, 2286194, 2286195, 2286199, 2286206, 2286214, 2286215,
  2286216, 2286217, 2286233, 2286238, 2286243, 2286245, 2286249, 2286251,
  2286252, 2286253, 2286260, 2286266, 2286272, 2286273, 2286283, 2286284,
  2286285, 2286286, 2286287, 2286288, 2286299, 2286303, 2286306, 2286307,
  2286311, 2286317, 2286318, 2286322, 2286327, 2286342, 2286346, 2286348,
  2286349, 2286350, 2286352, 2286353, 2286356, 2286357, 2286363, 2286377,
  2286392, 2286397, 2286403, 2286413, 2286420, 2286422, 2286423, 2286428,
  2286429, 2286432, 2286439, 2286440, 2286443, 2286445, 2286459, 2286460,
  2286467, 2286468, 2286472, 2286473, 2286476, 2286477, 2286484, 2286489,
  2286498, 2286508, 2286516, 2286523, 2286537, 2286540, 2286544, 2286547,
  2286556, 2286568, 2286570, 2286575, 2286578, 2286579, 2286581, 2286583,
  2286585, 2286590, 2286593, 2286595, 2286601, 2286612, 2286613, 2286618,
  2286619, 2286620, 2286622, 2286628, 2286636, 2286648, 2286654, 2286655,
  2286663, 2286668, 2286669, 2286671, 2286681, 2286687, 2286690, 2286691,
  2286699, 2286701, 2286702, 2286713, 2286718, 2286721, 2286722, 2286731,
  2286736, 2286737, 2286744, 2286747, 2286752, 2286772, 2286773, 2286780,
  2286786, 2286789, 2286797, 2286814, 2286820, 2286823, 2286827, 2286828,
  2286832, 2286833, 2286839, 2286840, 2286844, 2286846, 2286860, 2286867,
  2286881, 2286883, 2286885, 2286886, 2286908, 2286913, 2286937, 2286939,
  2286940, 2286943, 2286955, 2286969, 2286976, 2286979, 2286986, 2286988,
  2286994, 2286995, 2286997, 2286998, 2287003, 2287009, 2287023, 2287028,
  2287030, 2287037, 2287040, 2287046, 2287059, 2287065, 2287071, 2287086,
  2287093, 2287097, 2287100, 2287103, 2287105, 2287109, 2287110, 2287111,
  2287125, 2287128, 2287133, 2287138, 2287140, 2287144, 2287156, 2287163,
  2287174, 2287179, 2287191, 2287197, 2287201, 2287206, 2287213, 2287215,
  2287223, 2287225, 2287229, 2287235, 2287239, 2287252, 2287265, 2287271,
  2287280, 2287282, 2287286, 2287298, 2287303, 2287305, 2287321, 2287336,
  2287342, 2287346, 2287359, 2287367, 2287371, 2287374, 2287380, 2287386,
  2287389, 2287395, 2287404, 2287407, 2287421, 2287429, 2287436, 2287440,
  2287458, 2287459, 2287462, 2287467, 2287471, 2287486, 2287496, 2287522,
  2287524, 2287526, 2287532, 2287533, 2287543, 2287546, 2287549, 2287556,
  2287563, 2287566, 2287568, 2287573, 2287578, 2287604, 2287605, 2287612,
  2287619, 2287621, 2287637, 2287638, 2287646, 2287649, 2287653, 2287656,
  2287659, 2287670, 2287676, 2287679, 2287686, 2287704, 2287707, 2287715,
  2287718, 2287733, 2287741, 2287750, 2287751, 2287757, 2287767, 2287770,
  2287771, 2287788, 2287790, 2287795, 2287797, 2287805, 2287808, 2287815,
  2287827, 2287832, 2287836, 2287842, 2287846, 2287848, 2287853, 2287856,
  2287858, 2287871, 2287874, 2287878, 2287884, 2287885, 2287891, 2287908,
  2287915, 2287916, 2287921, 2287922, 2287930, 2287934, 2287940, 2287943,
  2287951, 2287965, 2287971, 2287972, 2287976, 2287978, 2287979, 2287980,
  2287990, 2287992, 2287993, 2287997, 2288024, 2288034, 2288036, 2288039,
  2288043, 2288050, 2288055, 2288061, 2288069, 2288079, 2288082, 2288084,
  2288090, 2288092, 2288095, 2288096, 2288104, 2288110, 2288119, 2288122,
  2288128, 2288134, 2288137, 2288144, 2288146, 2288148, 2288164, 2288165,
  2288169, 2288174, 2288176, 2288183, 2288193, 2288204, 2288208, 2288209,
  2288213, 2288215, 2288225, 2288227, 2288240, 2288248, 2288264, 2288265,
  2288266, 2288273, 2288282, 2288284, 2288287, 2288301, 2288302, 2288303,
  2288307, 2288323, 2288330, 2288332, 2288333, 2288335, 2288340, 2288354,
  2288357, 2288370, 2288376, 2288377, 2288380, 2288384, 2288401, 2288402,
  2288408, 2288416, 2288418, 2288431, 2288432, 2288457, 2288460, 2288463,
  2288470, 2288482, 2288485, 2288486, 2288498, 2288505, 2288515, 2288521,
  2288526, 2288529, 2288534, 2288539, 2288548, 2288549, 2288552, 2288554,
  2288592, 2288599, 2288600, 2288601, 2288605, 2288606, 2288620, 2288625,
  2288630, 2288644, 2288646, 2288653, 2288661, 2288668, 2288683, 2288684,
  2288691, 2288726, 2288732, 2288737, 2288741, 2288747, 2288749, 2288751,
  2288756, 2288758, 2288763, 2288769, 2288790, 2288792, 2288793, 2288795,
  2288803, 2288804, 2288806, 2288819, 2288821, 2288829, 2288835, 2288840,
  2288846, 2288850, 2288873, 2288874, 2288887, 2288894, 2288896, 2288897,
  2288899, 2288901, 2288902, 2288903, 2288916, 2288924, 2288929, 2288930,
  2288939, 2288943, 2288952, 2288953, 2288955, 2288958, 2288960, 2288962,
  2288965, 2288970, 2288987, 2288990, 2288991, 2288996, 2288998, 2289000,
  2289003, 2289014, 2289015, 2289031, 2289046, 2289049, 2289051, 2289053,
  2289058, 2289060, 2289061, 2289062, 2289063, 2289064, 2289077, 2289085,
  2289098, 2289107, 2289109, 2289111, 2289113, 2289116, 2289125, 2289126,
  2289130, 2289132, 2289137, 2289142, 2289144, 2289149, 2289150, 2289159,
  2289160, 2289163, 2289173, 2289184, 2289187, 2289188, 2289189, 2289195,
  2289200, 2289204, 2289205, 2289213, 2289218, 2289226, 2289241, 2289262,
  2289275, 2289277, 2289284, 2289285, 2289286, 2289289, 2289295, 2289302,
  2289303, 2289305, 2289308, 2289309, 2289314, 2289317, 2289328, 2289329,
  2289332, 2289333, 2289335, 2289338, 2289339, 2289350, 2289352, 2289356,
  2289357, 2289359, 2289360, 2289361, 2289367, 2289369, 2289381, 2289382,
  2289397, 2289429, 2289441, 2289448, 2289455, 2289456, 2289459, 2289466,
  2289467, 2289469, 2289478, 2289480, 2289483, 2289485, 2289488, 2289508,
  2289511, 2289533, 2289535, 2289536, 2289541, 2289548, 2289552, 2289554,
  2289564, 2289567, 2289569, 2289580, 2289583, 2289590, 2289594, 2289598,
  2289605, 2289609, 2289613, 2289619, 2289627, 2289633, 2289641, 2289643,
  2289647, 2289659, 2289664, 2289672, 2289677, 2289681, 2289688, 2289690,
  2289702, 2289706, 2289710, 2289720, 2289721, 2289736, 2289739, 2289746,
  2289750, 2289753, 2289756, 2289758, 2289759, 2289761, 2289764, 2289771,
  2289780, 2289784, 2289796, 2289799, 2289814, 2289816, 2289825, 2289830,
  2289831, 2289840, 2289853, 2289854, 2289861, 2289867, 2289869, 2289872,
  2289873, 2289895, 2289906, 2289907, 2289913, 2289917, 2289919, 2289920,
  2289922, 2289925, 2289928, 2289932, 2289937, 2289943, 2289950, 2289954,
  2289970, 2289972, 2289976, 2289998, 2290001, 2290014, 2290019, 2290023,
  2290025, 2290031, 2290039, 2290045, 2290047, 2290049, 2290051, 2290066,
  2290068, 2290069, 2290071, 2290077, 2290080, 2290085, 2290094, 2290097,
  2290111, 2290138, 2290141, 2290145, 2290154, 2290158, 2290163, 2290164,
  2290165, 2290191, 2290192, 2290199, 2290224, 2290232, 2290234, 2290237,
  2290245, 2290251, 2290255, 2290262, 2290275, 2290279, 2290281, 2290285,
  2290293, 2290296, 2290299, 2290304, 2290309, 2290310, 2290313, 2290314,
  2290325, 2290327, 2290330, 2290338, 2290342, 2290364, 2290370, 2290377,
  2290378, 2290384, 2290395, 2290405, 2290410, 2290411, 2290413, 2290420,
  2290421, 2290430, 2290434, 2290435, 2290438, 2290441, 2290460, 2290461,
  2290464, 2290482, 2290486, 2290491, 2290494, 2290498, 2290503, 2290508,
  2290513, 2290514, 2290517, 2290518, 2290520, 2290524, 2290525, 2290527,
  2290528, 2290531, 2290540, 2290545, 2290550, 2290553, 2290557, 2290575,
  2290577, 2290578, 2290579, 2290589, 2290596, 2290601, 2290615, 2290617,
  2290624, 2290635, 2290642, 2290644, 2290660, 2290663, 2290668, 2290669,
  2290673, 2290682, 2290687, 2290689, 2290699, 2290701, 2290709, 2290715,
  2290716, 2290721, 2290722, 2290726, 2290731, 2290739, 2290747, 2290758,
  2290760, 2290765, 2290768, 2290772, 2290776, 2290778, 2290780, 2290784,
  2290785, 2290795, 2290796, 2290814, 2290823, 2290840, 2290844, 2290853,
  2290854, 2290860, 2290873, 2290877, 2290879, 2290883, 2290886, 2290893,
  2290898, 2290909, 2290912, 2290915, 2290916, 2290920, 2290922, 2290925,
  2290927, 2290951, 2290956, 2290962, 2290965, 2290968, 2290971, 2290972,
  2290976, 2290977, 2290978, 2290984, 2290988, 2290997, 2290998, 2291015,
  2291023, 2291025, 2291040, 2291041, 2291045, 2291057, 2291063, 2291070,
  2291075, 2291076, 2291078, 2291093, 2291101, 2291102, 2291106, 2291111,
  2291124, 2291130, 2291132, 2291140, 2291146, 2291150, 2291153, 2291162,
  2291168, 2291169, 2291170, 2291175, 2291178, 2291180, 2291181, 2291186,
  2291195, 2291196, 2291203, 2291208, 2291219, 2291244, 2291249, 2291251,
  2291252, 2291272, 2291275, 2291283, 2291295, 2291303, 2291306, 2291310,
  2291325, 2291329, 2291331, 2291334, 2291344, 2291353, 2291362, 2291363,
  2291370, 2291373, 2291376, 2291377, 2291378, 2291379, 2291384, 2291386,
  2291399, 2291402, 2291405, 2291414, 2291416, 2291418, 2291423, 2291429,
  2291432, 2291441, 2291442, 2291443, 2291452, 2291475, 2291477, 2291478,
  2291500, 2291501, 2291503, 2291504, 2291506, 2291509, 2291520, 2291522,
  2291524, 2291563, 2291568, 2291579, 2291584, 2291588, 2291600, 2291606,
  2291617, 2291621, 2291629, 2291638, 2291640, 2291644, 2291650, 2291657,
  2291659, 2291661, 2291662, 2291669, 2291674, 2291676, 2291687, 2291688,
  2291701, 2291706, 2291708, 2291716, 2291717, 2291724, 2291735, 2291742,
  2291748, 2291749, 2291754, 2291757, 2291763, 2291764, 2291772, 2291773,
  2291776, 2291780, 2291790, 2291793, 2291811, 2291813, 2291825, 2291828,
  2291832, 2291836, 2291838, 2291845, 2291852, 2291855, 2291865, 2291871,
  2291874, 2291880, 2291892, 2291900, 2291909, 2291917, 2291939, 2291943,
  2291948, 2291950, 2291960, 2291962, 2291983, 2291993, 2292004, 2292008,
  2292023, 2292024, 2292032, 2292033, 2292036, 2292043, 2292045, 2292053,
  2292058, 2292060, 2292064, 2292075, 2292085, 2292094, 2292096, 2292097,
  2292100, 2292107, 2292111, 2292120, 2292122, 2292132, 2292145, 2292146,
  2292148, 2292153, 2292155, 2292156, 2292157, 2292164, 2292165, 2292168,
  2292169, 2292172, 2292177, 2292186, 2292187, 2292197, 2292203, 2292204,
  2292210, 2292216, 2292222, 2292245, 2292250, 2292251, 2292253, 2292280,
  2292291, 2292295, 2292300, 2292308, 2292316, 2292329, 2292331, 2292337,
  2292348, 2292357, 2292359, 2292368, 2292370, 2292384, 2292385, 2292398,
  2292401, 2292421, 2292429, 2292435, 2292436, 2292443, 2292449, 2292450,
  2292458, 2292459, 2292463, 2292469, 2292470, 2292477, 2292481, 2292489,
  2292492, 2292497, 2292510, 2292526, 2292527, 2292536, 2292539, 2292541,
  2292555, 2292560, 2292561, 2292564, 2292565, 2292571, 2292575, 2292579,
  2292602, 2292610, 2292621, 2292625, 2292646, 2292658, 2292659, 2292673,
  2292674, 2292682, 2292684, 2292688, 2292691, 2292706, 2292707, 2292709,
  2292711, 2292718, 2292719, 2292728, 2292746, 2292776, 2292777, 2292785,
  2292789, 2292792, 2292804, 2292818, 2292820, 2292821, 2292826, 2292832,
  2292834, 2292844, 2292852, 2292856, 2292863, 2292868, 2292869, 2292884,
  2292902, 2292903, 2292912, 2292917, 2292924, 2292926, 2292930, 2292940,
  2292942, 2292943, 2292947, 2292955, 2292959, 2292961, 2292968, 2292980,
  2292990, 2292995, 2292999, 2293007, 2293009, 2293010, 2293018, 2293024,
  2293028, 2293041, 2293052, 2293053, 2293057, 2293059, 2293066, 2293068,
  2293070, 2293073, 2293074, 2293080, 2293081, 2293084, 2293100, 2293114,
  2293118, 2293119, 2293122, 2293133, 2293138, 2293145, 2293147, 2293148,
  2293151, 2293152, 2293160, 2293177, 2293178, 2293179, 2293184, 2293201,
  2293212, 2293216, 2293224, 2293230, 2293236, 2293252, 2293264, 2293279,
  2293284, 2293290, 2293292, 2293305, 2293311, 2293315, 2293320, 2293325,
  2293333, 2293338, 2293342, 2293349, 2293355, 2293368, 2293373, 2293383,
  2293391, 2293394, 2293396, 2293398, 2293405, 2293413, 2293415, 2293420,
  2293428, 2293429, 2293430, 2293433, 2293439, 2293445, 2293447, 2293453,
  2293455, 2293460, 2293482, 2293488, 2293490, 2293493, 2293495, 2293497,
  2293498, 2293542, 2293544, 2293554, 2293559, 2293567, 2293569, 2293578,
  2293594, 2293599, 2293614, 2293621, 2293624, 2293632, 2293634, 2293636,
  2293651, 2293653, 2293654, 2293678, 2293683, 2293693, 2293709, 2293725,
  2293727, 2293729, 2293731, 2293733, 2293738, 2293746, 2293750, 2293763,
  2293771, 2293786, 2293788, 2293789, 2293790, 2293806, 2293808, 2293809,
  2293811, 2293815, 2293823, 2293826, 2293830, 2293833, 2293834, 2293836,
  2293839, 2293843, 2293849, 2293860, 2293869, 2293873, 2293875, 2293884,
  2293897, 2293907, 2293908, 2293918, 2293928, 2293932, 2293935, 2293943,
  2293947, 2293948, 2293951, 2293954, 2293972, 2293977, 2293985, 2293993,
  2293994, 2294001, 2294014, 2294015, 2294020, 2294039, 2294050, 2294078,
  2294080, 2294085, 2294086, 2294090, 2294104, 2294124, 2294133, 2294137,
  2294140, 2294141, 2294147, 2294149, 2294152, 2294157, 2294159, 2294162,
  2294168, 2294181, 2294183, 2294190, 2294204, 2294210, 2294213, 2294220,
  2294233, 2294239, 2294244, 2294248, 2294251, 2294256, 2294268, 2294270,
  2294273, 2294280, 2294289, 2294295, 2294298, 2294303, 2294304, 2294312,
  2294333, 2294341, 2294353, 2294358, 2294363, 2294368, 2294369, 2294383,
  2294416, 2294423, 2294428, 2294432, 2294434, 2294437, 2294440, 2294442,
  2294446, 2294447, 2294452, 2294455, 2294471, 2294476, 2294477, 2294483,
  2294484, 2294491, 2294499, 2294506, 2294510, 2294520, 2294525, 2294528,
  2294531, 2294532, 2294533, 2294536, 2294541, 2294546, 2294556, 2294570,
  2294571, 2294578, 2294580, 2294581, 2294590, 2294602, 2294604, 2294612,
  2294620, 2294625, 2294626, 2294627, 2294642, 2294650, 2294653, 2294658,
  2294663, 2294666, 2294667, 2294668, 2294671, 2294672, 2294680, 2294686,
  2294690, 2294692, 2294698, 2294701, 2294710, 2294719, 2294721, 2294722,
  2294723, 2294731, 2294734, 2294735, 2294737, 2294741, 2294748, 2294750,
  2294754, 2294758, 2294765, 2294785, 2294801, 2294813, 2294816, 2294818,
  2294833, 2294849, 2294850, 2294859, 2294862, 2294866, 2294881, 2294888,
  2294898, 2294899, 2294903, 2294905, 2294922, 2294924, 2294926, 2294931,
  2294935, 2294941, 2294947, 2294950, 2294952, 2294956, 2294957, 2294959,
  2294960, 2294966, 2294973, 2294975, 2294976, 2294999, 2295001, 2295003,
  2295009, 2295010, 2295014, 2295020, 2295021, 2295025, 2295026, 2295034,
  2295042, 2295043, 2295047, 2295058, 2295065, 2295093, 2295095, 2295097,
  2295098, 2295099, 2295103, 2295114, 2295115, 2295119, 2295122, 2295127,
  2295133, 2295135, 2295136, 2295144, 2295149, 2295162, 2295172, 2295188,
  2295207, 2295208, 2295210, 2295216, 2295219, 2295221, 2295223, 2295228,
  2295240, 2295244, 2295249, 2295252, 2295253, 2295256, 2295259, 2295262,
  2295266, 2295281, 2295285, 2295286, 2295292, 2295307, 2295308, 2295319,
  2295321, 2295322, 2295326, 2295330, 2295334, 2295338, 2295344, 2295347,
  2295357, 2295364, 2295366, 2295374, 2295376, 2295380, 2295387, 2295402,
  2295403, 2295407, 2295408, 2295412, 2295414, 2295415, 2295423, 2295425,
  2295426, 2295436, 2295441, 2295448, 2295482, 2295486, 2295491, 2295492,
  2295499, 2295515, 2295521, 2295524, 2295529, 2295533, 2295535, 2295557,
  2295572, 2295574, 2295579, 2295581, 2295590, 2295602, 2295605, 2295608,
  2295613, 2295615, 2295617, 2295618, 2295622, 2295623, 2295636, 2295637,
  2295640, 2295642, 2295646, 2295649, 2295653, 2295654, 2295666, 2295682,
  2295693, 2295701, 2295703, 2295708, 2295717, 2295719, 2295727, 2295730,
  2295734, 2295758, 2295771, 2295777, 2295780, 2295788, 2295794, 2295801,
  2295806, 2295812, 2295818, 2295820, 2295822, 2295825, 2295827, 2295832,
  2295845, 2295849, 2295851, 2295853, 2295856, 2295859, 2295864, 2295865,
  2295874, 2295882, 2295887, 2295891, 2295896, 2295897, 2295901, 2295910,
  2295913, 2295916, 2295920, 2295921, 2295922, 2295929, 2295930, 2295939,
  2295949, 2295951, 2295958, 2295959, 2295971, 2295976, 2295978, 2295980,
  2295982, 2295984, 2295987, 2295992, 2295996, 2296000, 2296018, 2296025,
  2296030, 2296032, 2296036, 2296038, 2296043, 2296051, 2296052, 2296053,
  2296055, 2296056, 2296059, 2296061, 2296066, 2296068, 2296072, 2296074,
  2296082, 2296086, 2296089, 2296096, 2296098, 2296104, 2296105, 2296112,
  2296121, 2296140, 2296148, 2296158, 2296161, 2296173, 2296183, 2296189,
  2296200, 2296203, 2296210, 2296214, 2296226, 2296231, 2296232, 2296243,
  2296245, 2296258, 2296264, 2296266, 2296279, 2296285, 2296302, 2296304,
  2296307, 2296319, 2296327, 2296331, 2296345, 2296350, 2296356, 2296358,
  2296359, 2296360, 2296371, 2296372, 2296374, 2296377, 2296379, 2296382,
  2296402, 2296406, 2296409, 2296410, 2296411, 2296418, 2296419, 2296422,
  2296425, 2296427, 2296428, 2296439, 2296440, 2296449, 2296455, 2296461,
  2296464, 2296504, 2296508, 2296531, 2296533, 2296545, 2296548, 2296550,
  2296554, 2296555, 2296564, 2296566, 2296572, 2296582, 2296586, 2296602,
  2296610, 2296611, 2296612, 2296613, 2296614, 2296622, 2296627, 2296630,
  2296632, 2296633, 2296634, 2296635, 2296638, 2296645, 2296646, 2296647,
  2296648, 2296650, 2296655, 2296658, 2296659, 2296660, 2296661, 2296665,
  2296666, 2296668, 2296672, 2296673, 2296674, 2296677, 2296680, 2296683,
  2296685, 2296690, 2296694, 2296695, 2296699, 2296702, 2296703, 2296704,
  2296716, 2296719, 2296721, 2296722, 2296727, 2296733, 2296735, 2296738,
  2296745, 2296746, 2296748, 2296750, 2296760, 2296762, 2296763, 2296767,
  2296768, 2296773, 2296783, 2296786, 2296788, 2296791, 2296793, 2296795,
  2296798, 2296803, 2296806, 2296809, 2296816, 2296823, 2296830, 2296831,
  2296833, 2296843, 2296847, 2296863, 2296866, 2296867, 2296868, 2296872,
  2296874, 2296875, 2296878, 2296882, 2296885, 2296892, 2296895, 2296901,
  2296904, 2296906, 2296907, 2296908, 2296911, 2296917, 2296918, 2296924,
  2296929, 2296934, 2296935, 2296937, 2296940, 2296943, 2296944, 2296946,
  2296947, 2296948, 2296950, 2296953, 2296956, 2296960, 2296961, 2296965,
  2296966, 2296974, 2296975, 2296978, 2296979, 2296980, 2296982, 2296985,
  2296986, 2296987, 2296994, 2296999, 2297001, 2297007, 2297012, 2297013,
  2297014, 2297021, 2297031, 2297034, 2297043, 2297047, 2297052, 2297053,
  2297074, 2297082, 2297085, 2297090, 2297091, 2297093, 2297097, 2297098,
  2297099, 2297100, 2297103, 2297110, 2297111, 2297114, 2297117, 2297119,
  2297121, 2297126, 2297127, 2297130, 2297134, 2297140, 2297146, 2297148,
  2297153, 2297157, 2297162, 2297166, 2297169, 2297174, 2297182, 2297185,
  2297186, 2297189, 2297191, 2297193, 2297195, 2297196, 2297198, 2297201,
  2297208, 2297209, 2297218, 2297221, 2297222, 2297224, 2297226, 2297229,
  2297231, 2297236, 2297240, 2297249, 2297252, 2297253, 2297260, 2297262,
  2297263, 2297265, 2297266, 2297268, 2297273, 2297274, 2297276, 2297279,
  2297280, 2297283, 2297286, 2297289, 2297290, 2297291, 2297295, 2297297,
  2297303, 2297306, 2297308, 2297310, 2297314, 2297315, 2297318, 2297320,
  2297323, 2297324, 2297325, 2297327, 2297345, 2297346, 2297352, 2297355,
  2297357, 2297358, 2297360, 2297362, 2297364, 2297365, 2297366, 2297368,
  2297370, 2297371, 2297373, 2297387, 2297390, 2297391, 2297393, 2297398,
  2297399, 2297403, 2297405, 2297412, 2297413, 2297415, 2297418, 2297426,
  2297431, 2297433, 2297435, 2297438, 2297441, 2297442, 2297446, 2297448,
  2297449, 2297459, 2297461, 2297462, 2297465, 2297466, 2297467, 2297468,
  2297475, 2297479, 2297484, 2297488, 2297489, 2297490, 2297492, 2297493,
  2297497, 2297502, 2297506, 2297509, 2297514, 2297515, 2297521, 2297522,
  2297534, 2297536, 2297537, 2297538, 2297539, 2297541, 2297543, 2297553,
  2297554, 2297555, 2297558, 2297560, 2297563, 2297567, 2297571, 2297573,
  2297575, 2297577, 2297581, 2297582, 2297583, 2297584, 2297589, 2297591,
  2297597, 2297600, 2297601, 2297607, 2297608, 2297621, 2297623, 2297625,
  2297629, 2297633, 2297637, 2297639, 2297641, 2297642, 2297644, 2297649,
  2297650, 2297652, 2297658, 2297660, 2297663, 2297665, 2297671, 2297674,
  2297677, 2297678, 2297680, 2297686, 2297688, 2297691, 2297696, 2297709,
  2297710, 2297714, 2297716, 2297721, 2297723, 2297724, 2297730, 2297736,
  2297740, 2297743, 2297746, 2297747, 2297751, 2297754, 2297756, 2297759,
  2297760, 2297763, 2297766, 2297772, 2297773, 2297775, 2297783, 2297784,
  2297789, 2297803, 2297804, 2297809, 2297813, 2297817, 2297827, 2297829,
  2297834, 2297835, 2297836, 2297837, 2297838, 2297846, 2297852, 2297856,
  2297857, 2297859, 2297862, 2297866, 2297867, 2297871, 2297877, 2297886,
  2297889, 2297900, 2297901, 2297902, 2297906, 2297907, 2297911, 2297914,
  2297916, 2297924, 2297926, 2297927, 2297929, 2297932, 2297933, 2297935,
  2297936, 2297945, 2297948, 2297951, 2297952, 2297954, 2297956, 2297957,
  2297959, 2297964, 2297967, 2297972, 2297974, 2297975, 2297983, 2297986,
  2297989, 2297991, 2297993, 2297999, 2298001, 2298006, 2298013, 2298014,
  2298018, 2298033, 2298035, 2298036, 2298037, 2298038, 2298040, 2298042,
  2298045, 2298054, 2298057, 2298058, 2298064, 2298069, 2298081, 2298088,
  2298092, 2298093, 2298094, 2298100, 2298101, 2298107, 2298115, 2298120,
  2298124, 2298131, 2298142, 2298143, 2298146, 2298147, 2298149, 2298152,
  2298154, 2298164, 2298167, 2298171, 2298174, 2298184, 2298186, 2298189,
  2298191, 2298195, 2298200, 2298205, 2298207, 2298211, 2298214, 2298217,
  2298221, 2298223, 2298227, 2298228, 2298232, 2298237, 2298240, 2298244,
  2298247, 2298249, 2298251, 2298255, 2298264, 2298265, 2298269, 2298270,
  2298274, 2298279, 2298281, 2298284, 2298285, 2298286, 2298288, 2298290,
  2298291, 2298292, 2298293, 2298300, 2298301, 2298303, 2298315, 2298318,
  2298319, 2298329, 2298331, 2298335, 2298337, 2298339, 2298343, 2298344,
  2298351, 2298354, 2298356, 2298359, 2298362, 2298364, 2298386, 2298394,
  2298396, 2298397, 2298399, 2298404, 2298407, 2298408, 2298410, 2298413,
  2298414, 2298418, 2298419, 2298420, 2298426, 2298432, 2298435, 2298437,
  2298438, 2298445, 2298446, 2298448, 2298451, 2298455, 2298457, 2298460,
  2298463, 2298464, 2298466, 2298467, 2298468, 2298470, 2298473, 2298481,
  2298485, 2298487, 2298489, 2298495, 2298500, 2298503, 2298506, 2298509,
  2298518, 2298520, 2298525, 2298526, 2298527, 2298528, 2298531, 2298533,
  2298537, 2298539, 2298541, 2298542, 2298544, 2298546, 2298553, 2298554,
  2298558, 2298560, 2298564, 2298566, 2298570, 2298572, 2298573, 2298575,
  2298579, 2298580, 2298581, 2298583, 2298584, 2298588, 2298592, 2298598,
  2298604, 2298605, 2298608, 2298610, 2298613, 2298619, 2298620, 2298622,
  2298623, 2298624, 2298626, 2298639, 2298646, 2298648, 2298658, 2298663,
  2298664, 2298665, 2298666, 2298667, 2298669, 2298670, 2298675, 2298676,
  2298677, 2298679, 2298680, 2298682, 2298696, 2298697, 2298699, 2298700,
  2298701, 2298702, 2298705, 2298706, 2298711, 2298713, 2298717, 2298719,
  2298722, 2298724, 2298727, 2298729, 2298730, 2298731, 2298735, 2298740,
  2298744, 2298745, 2298746, 2298751, 2298754, 2298756, 2298760, 2298761,
  2298763, 2298772, 2298774, 2298777, 2298779, 2298787, 2298788, 2298798,
  2298804, 2298806, 2298808, 2298814, 2298815, 2298818, 2298821, 2298831,
  2298835, 2298838, 2298839, 2298842, 2298843, 2298844, 2298849, 2298850,
  2298856, 2298858, 2298866, 2298871, 2298877, 2298878, 2298879, 2298883,
  2298886, 2298888, 2298890, 2298901, 2298907, 2298919, 2298920, 2298927,
  2298929, 2298930, 2298933, 2298934, 2298941, 2298944, 2298946, 2298951,
  2298955, 2298956, 2298969, 2298974, 2298975, 2298980, 2298981, 2298982,
  2298984, 2298986, 2298988, 2298991, 2298997, 2298998, 2298999, 2299001,
  2299005, 2299008, 2299009, 2299010, 2299014, 2299015, 2299021, 2299024,
  2299029, 2299030, 2299034, 2299038, 2299041, 2299043, 2299047, 2299053,
  2299059, 2299061, 2299062, 2299072, 2299079, 2299082, 2299087, 2299089,
  2299093, 2299095, 2299097, 2299099, 2299105, 2299107, 2299108, 2299113,
  2299114, 2299115, 2299124, 2299127, 2299129, 2299131, 2299132, 2299134,
  2299146, 2299147, 2299154, 2299155, 2299156, 2299158, 2299159, 2299163,
  2299164, 2299165, 2299168, 2299171, 2299172, 2299173, 2299186, 2299187,
  2299196, 2299197, 2299203, 2299207, 2299210, 2299211, 2299214, 2299216,
  2299219, 2299223, 2299229, 2299230, 2299234, 2299239, 2299243, 2299248,
  2299255, 2299260, 2299261, 2299272, 2299277, 2299281, 2299283, 2299285,
  2299288, 2299291, 2299294, 2299296, 2299297, 2299301, 2299304, 2299309,
  2299312, 2299313, 2299314, 2299324, 2299326, 2299327, 2299333, 2299336,
  2299337, 2299338, 2299340, 2299341, 2299342, 2299347, 2299348, 2299349,
  2299354, 2299356, 2299366, 2299367, 2299370, 2299373, 2299375, 2299381,
  2299382, 2299390, 2299392, 2299395, 2299402, 2299408, 2299409, 2299415,
  2299416, 2299417, 2299420, 2299425, 2299431, 2299432, 2299436, 2299441,
  2299444, 2299450, 2299458, 2299460, 2299461, 2299464, 2299470, 2299475,
  2299479, 2299486, 2299489, 2299490, 2299491, 2299493, 2299498, 2299505,
  2299509, 2299513, 2299517, 2299518, 2299519, 2299529, 2299531, 2299535,
  2299539, 2299542, 2299544, 2299545, 2299547, 2299554, 2299555, 2299563,
  2299565, 2299570, 2299573, 2299579, 2299582, 2299589, 2299592, 2299594,
  2299595, 2299596, 2299597, 2299599, 2299604, 2299606, 2299607, 2299610,
  2299616, 2299617, 2299619, 2299623, 2299624, 2299625, 2299630, 2299632,
  2299636, 2299652, 2299660, 2299661, 2299663, 2299664, 2299682, 2299683,
  2299688, 2299705, 2299709, 2299711, 2299716, 2299720, 2299723, 2299724,
  2299725, 2299727, 2299731, 2299732, 2299733, 2299734, 2299738, 2299740,
  2299741, 2299743, 2299745, 2299748, 2299750, 2299752, 2299753, 2299755,
  2299757, 2299759, 2299760, 2299763, 2299765, 2299769, 2299771, 2299776,
  2299778, 2299779, 2299781, 2299783, 2299784, 2299790, 2299794, 2299797,
  2299798, 2299800, 2299802, 2299804, 2299809, 2299814, 2299815, 2299825,
  2299829, 2299832, 2299836, 2299837, 2299842, 2299844, 2299845, 2299848,
  2299851, 2299856, 2299863, 2299869, 2299872, 2299876, 2299881, 2299886,
  2299890, 2299892, 2299893, 2299894, 2299909, 2299912, 2299914, 2299917,
  2299922, 2299926, 2299929, 2299930, 2299931, 2299944, 2299946, 2299949,
  2299950, 2299957, 2299961, 2299965, 2299968, 2299971, 2299972, 2299973,
  2299980, 2299982, 2299987, 2299990, 2299993, 2299995, 2299997, 2300002,
  2300006, 2300009, 2300013, 2300015, 2300017, 2300018, 2300019, 2300022,
  2300028, 2300029, 2300041, 2300046, 2300048, 2300050, 2300053, 2300061,
  2300076, 2300077, 2300087, 2300089, 2300090, 2300093, 2300098, 2300102,
  2300103, 2300108, 2300112, 2300114, 2300129, 2300132, 2300133, 2300145,
  2300147, 2300151, 2300156, 2300158, 2300160, 2300162, 2300168, 2300170,
  2300171, 2300172, 2300174, 2300175, 2300179, 2300182, 2300183, 2300184,
  2300186, 2300193, 2300197, 2300201, 2300210, 2300211, 2300215, 2300222,
  2300235, 2300239, 2300245, 2300252, 2300253, 2300257, 2300258, 2300262,
  2300264, 2300267, 2300268, 2300269, 2300272, 2300276, 2300277, 2300281,
  2300284, 2300285, 2300286, 2300298, 2300299, 2300301, 2300302, 2300303,
  2300305, 2300307, 2300308, 2300309, 2300315, 2300316, 2300321, 2300325,
  2300329, 2300330, 2300332, 2300339, 2300344, 2300348, 2300349, 2300361,
  2300364, 2300366, 2300369, 2300373, 2300374, 2300376, 2300378, 2300386,
  2300391, 2300393, 2300396, 2300401, 2300405, 2300410, 2300413, 2300414,
  2300415, 2300416, 2300421, 2300426, 2300428, 2300431, 2300436, 2300438,
  2300441, 2300442, 2300445, 2300448, 2300450, 2300451, 2300453, 2300456,
  2300461, 2300470, 2300482, 2300483, 2300484, 2300489, 2300490, 2300494,
  2300496, 2300508, 2300510, 2300512, 2300516, 2300520, 2300526, 2300529,
  2300531, 2300544, 2300545, 2300547, 2300548, 2300561, 2300565, 2300570,
  2300573, 2300574, 2300578, 2300585, 2300587, 2300588, 2300591, 2300598,
  2300602, 2300605, 2300607, 2300608, 2300611, 2300618, 2300620, 2300621,
  2300624, 2300635, 2300642, 2300644, 2300651, 2300653, 2300656, 2300660,
  2300665, 2300667, 2300670, 2300671, 2300674, 2300675, 2300676, 2300677,
  2300678, 2300687, 2300691, 2300695, 2300705, 2300709, 2300712, 2300716,
  2300728, 2300729, 2300731, 2300733, 2300736, 2300737, 2300746, 2300747,
  2300748, 2300751, 2300756, 2300760, 2300764, 2300766, 2300767, 2300768,
  2300769, 2300772, 2300777, 2300780, 2300783, 2300787, 2300793, 2300798,
  2300799, 2300803, 2300805, 2300808, 2300817, 2300820, 2300821, 2300823,
  2300826, 2300831, 2300840, 2300842, 2300854, 2300861, 2300863, 2300864,
  2300865, 2300867, 2300870, 2300876, 2300881, 2300882, 2300884, 2300885,
  2300886, 2300889, 2300890, 2300898, 2300902, 2300907, 2300911, 2300912,
  2300921, 2300929, 2300933, 2300935, 2300938, 2300939, 2300948, 2300951,
  2300956, 2300957, 2300962, 2300963, 2300968, 2300971, 2300975, 2300985,
  2300986, 2300989, 2300993, 2300994, 2300995, 2300998, 2301004, 2301005,
  2301020, 2301021, 2301022, 2301024, 2301026, 2301029, 2301030, 2301032,
  2301039, 2301040, 2301042, 2301044, 2301048, 2301049, 2301053, 2301057,
  2301058, 2301062, 2301065, 2301066, 2301068, 2301078, 2301079, 2301080,
  2301082, 2301084, 2301086, 2301090, 2301097, 2301108, 2301110, 2301112,
  2301113, 2301119, 2301120, 2301134, 2301135, 2301146, 2301147, 2301149,
  2301150, 2301153, 2301156, 2301164, 2301172, 2301176, 2301181, 2301185,
  2301187, 2301189, 2301191, 2301196, 2301200, 2301206, 2301209, 2301210,
  2301213, 2301214, 2301217, 2301221, 2301225, 2301226, 2301230, 2301231,
  2301232, 2301234, 2301235, 2301237, 2301241, 2301243, 2301246, 2301247,
  2301249, 2301251, 2301252, 2301256, 2301259, 2301261, 2301263, 2301264,
  2301265, 2301268, 2301271, 2301272, 2301273, 2301278, 2301280, 2301285,
  2301288, 2301290, 2301292, 2301297, 2301300, 2301302, 2301304, 2301309,
  2301312, 2301314, 2301316, 2301319, 2301333, 2301335, 2301336, 2301337,
  2301341, 2301345, 2301347, 2301350, 2301356, 2301358, 2301359, 2301360,
  2301364, 2301365, 2301368, 2301370, 2301372, 2301376, 2301380, 2301382,
  2301386, 2301388, 2301390, 2301391, 2301400, 2301403, 2301408, 2301412,
  2301414, 2301415, 2301416, 2301417, 2301419, 2301426, 2301429, 2301434,
  2301437, 2301439, 2301441, 2301444, 2301445, 2301447, 2301449, 2301450,
  2301451, 2301460, 2301461, 2301465, 2301469, 2301472, 2301475, 2301480,
  2301481, 2301482, 2301486, 2301490, 2301493, 2301500, 2301501, 2301502,
  2301505, 2301509, 2301512, 2301513, 2301521, 2301523, 2301525, 2301528,
  2301531, 2301536, 2301539, 2301545, 2301546, 2301547, 2301550, 2301552,
  2301553, 2301559, 2301567, 2301568, 2301580, 2301584, 2301600, 2301603,
  2301604, 2301611, 2301616, 2301617, 2301631, 2301634, 2301636, 2301642,
  2301644, 2301646, 2301649, 2301650, 2301651, 2301655, 2301656, 2301659,
  2301662, 2301668, 2301671, 2301679, 2301690, 2301692, 2301694, 2301695,
  2301697, 2301699, 2301706, 2301707, 2301710, 2301712, 2301715, 2301727,
  2301728, 2301730, 2301736, 2301742, 2301744, 2301745, 2301747, 2301748,
  2301749, 2301750, 2301753, 2301754, 2301761, 2301762, 2301763, 2301764,
  2301765, 2301770, 2301771, 2301772, 2301775, 2301781, 2301785, 2301787,
  2301788, 2301795, 2301801, 2301802, 2301807, 2301808, 2301810, 2301818,
  2301833, 2301835, 2301836, 2301842, 2301846, 2301848, 2301858, 2301859,
  2301862, 2301863, 2301869, 2301870, 2301871, 2301876, 2301877, 2301878,
  2301881, 2301884, 2301899, 2301902, 2301907, 2301909, 2301910, 2301912,
  2301916, 2301917, 2301923, 2301924, 2301926, 2301929, 2301937, 2301945,
  2301947, 2301949, 2301952, 2301953, 2301956, 2301962, 2301964, 2301965,
  2301968, 2301970, 2301971, 2301974, 2301978, 2301980, 2301981, 2301988,
  2301995, 2301999, 2302010, 2302013, 2302018, 2302021, 2302024, 2302025,
  2302026, 2302035, 2302036, 2302037, 2302041, 2302043, 2302044, 2302045,
  2302050, 2302052, 2302053, 2302058, 2302069, 2302072, 2302081, 2302086,
  2302087, 2302091, 2302093, 2302094, 2302096, 2302104, 2302111, 2302112,
  2302115, 2302120, 2302122, 2302125, 2302132, 2302135, 2302136, 2302139,
  2302142, 2302144, 2302146, 2302149, 2302152, 2302154, 2302155, 2302156,
  2302158, 2302166, 2302167, 2302168, 2302175, 2302178, 2302184, 2302186,
  2302189, 2302190, 2302191, 2302192, 2302193, 2302196, 2302200, 2302203,
  2302204, 2302207, 2302209, 2302215, 2302216, 2302224, 2302226, 2302227,
  2302228, 2302237, 2302245, 2302250, 2302255, 2302260, 2302261, 2302263,
  2302267, 2302269, 2302270, 2302273, 2302275, 2302280, 2302282, 2302287,
  2302289, 2302291, 2302298, 2302302, 2302304, 2302310, 2302313, 2302317,
  2302318, 2302319, 2302321, 2302325, 2302326, 2302330, 2302337, 2302339,
  2302340, 2302341, 2302349, 2302350, 2302356, 2302360, 2302361, 2302363,
  2302364, 2302375, 2302377, 2302380, 2302382, 2302397, 2302399, 2302409,
  2302410, 2302411, 2302419, 2302422, 2302423, 2302424, 2302430, 2302435,
  2302436, 2302437, 2302439, 2302444, 2302446, 2302456, 2302457, 2302458,
  2302471, 2302472, 2302477, 2302484, 2302485, 2302490, 2302491, 2302493,
  2302496, 2302513, 2302514, 2302516, 2302517, 2302520, 2302525, 2302535,
  2302538, 2302541, 2302545, 2302547, 2302549, 2302551, 2302554, 2302555,
  2302556, 2302558, 2302573, 2302582, 2302585, 2302586, 2302587, 2302592,
  2302593, 2302594, 2302595, 2302600, 2302603, 2302607, 2302608, 2302612,
  2302614, 2302616, 2302618, 2302625, 2302628, 2302637, 2302638, 2302641,
  2302645, 2302653, 2302661, 2302664, 2302665, 2302670, 2302675, 2302677,
  2302679, 2302680, 2302681, 2302682, 2302687, 2302690, 2302694, 2302695,
  2302696, 2302699, 2302706, 2302709, 2302711, 2302714, 2302716, 2302726,
  2302730, 2302739, 2302740, 2302741, 2302746, 2302747, 2302748, 2302750,
  2302752, 2302756, 2302762, 2302763, 2302764, 2302772, 2302774, 2302778,
  2302779, 2302783, 2302784, 2302792, 2302795, 2302797, 2302801, 2302803,
  2302804, 2302807, 2302808, 2302810, 2302811, 2302813, 2302816, 2302822,
  2302823, 2302826, 2302832, 2302834, 2302835, 2302840, 2302841, 2302842,
  2302846, 2302848, 2302851, 2302852, 2302854, 2302855, 2302856, 2302862,
  2302865, 2302873, 2302874, 2302878, 2302883, 2302890, 2302898, 2302903,
  2302905, 2302909, 2302910, 2302919, 2302923, 2302924, 2302928, 2302931,
  2302935, 2302938, 2302948, 2302958, 2302961, 2302965, 2302970, 2302972,
  2302975, 2302977, 2302979, 2302992, 2302994, 2303007, 2303011, 2303013,
  2303014, 2303017, 2303022, 2303032, 2303034, 2303035, 2303036, 2303038,
  2303041, 2303042, 2303047, 2303050, 2303051, 2303055, 2303058, 2303060,
  2303063, 2303073, 2303074, 2303075, 2303076, 2303078, 2303079, 2303087,
  2303088, 2303089, 2303093, 2303094, 2303095, 2303111, 2303112, 2303117,
  2303122, 2303123, 2303129, 2303130, 2303133, 2303134, 2303135, 2303136,
  2303140, 2303143, 2303149, 2303153, 2303154, 2303167, 2303176, 2303180,
  2303181, 2303183, 2303188, 2303189, 2303195, 2303197, 2303206, 2303208,
  2303213, 2303214, 2303215, 2303218, 2303219, 2303220, 2303224, 2303225,
  2303226, 2303227, 2303237, 2303242, 2303244, 2303245, 2303246, 2303250,
  2303253, 2303255, 2303258, 2303261, 2303262, 2303263, 2303267, 2303268,
  2303270, 2303271, 2303273, 2303277, 2303282, 2303283, 2303288, 2303289,
  2303295, 2303297, 2303303, 2303310, 2303311, 2303312, 2303313, 2303323,
  2303324, 2303341, 2303344, 2303351, 2303359, 2303360, 2303361, 2303367,
  2303369, 2303370, 2303373, 2303376, 2303383, 2303388, 2303389, 2303390,
  2303391, 2303393, 2303395, 2303399, 2303400, 2303410, 2303416, 2303417,
  2303420, 2303434, 2303438, 2303446, 2303449, 2303453, 2303460, 2303461,
  2303466, 2303481, 2303484, 2303486, 2303491, 2303494, 2303499, 2303501,
  2303502, 2303504, 2303505, 2303510, 2303513, 2303515, 2303519, 2303523,
  2303527, 2303529, 2303530, 2303533, 2303534, 2303538, 2303540, 2303541,
  2303543, 2303550, 2303551, 2303555, 2303562, 2303564, 2303569, 2303582,
  2303585, 2303586, 2303587, 2303588, 2303592, 2303597, 2303598, 2303599,
  2303601, 2303605, 2303609, 2303611, 2303612, 2303615, 2303617, 2303619,
  2303622, 2303625, 2303637, 2303639, 2303642, 2303646, 2303650, 2303651,
  2303652, 2303653, 2303657, 2303659, 2303661, 2303662, 2303665, 2303666,
  2303669, 2303670, 2303673, 2303678, 2303680, 2303682, 2303683, 2303685,
  2303689, 2303690, 2303697, 2303699, 2303703, 2303704, 2303705, 2303706,
  2303709, 2303715, 2303717, 2303718, 2303719, 2303721, 2303725, 2303728,
  2303729, 2303732, 2303735, 2303737, 2303745, 2303747, 2303749, 2303750,
  2303751, 2303752, 2303753, 2303759, 2303763, 2303769, 2303771, 2303786,
  2303790, 2303791, 2303792, 2303793, 2303796, 2303798, 2303799, 2303801,
  2303802, 2303804, 2303806, 2303809, 2303811, 2303812, 2303818, 2303820,
  2303823, 2303824, 2303825, 2303834, 2303835, 2303839, 2303846, 2303852,
  2303854, 2303860, 2303862,
]);

const byteLength = (s: string) => new TextEncoder().encode(s).length;

// This function is designed to modify objects returned by the database recursively
// such that known inevitable differences between the harvester and subquery are not
// detected in the diff.
const compensateAcceptedDifferences = (a: any, nested = false) => {
  if (typeof a === "object") {
    for (const i in a) {
      if (
        (!nested && (i === "attributes" || i === "params")) ||
        i === "call_args"
      ) {
        // Subquery doesn't have access to the same type info as the harvester.
        // Thankfully we don't use the type anywhere.
        for (const j in a[i]) {
          delete a[i][j]["type"];
          // We don't produce valueRaw in subquery.
          delete a[i][j]["valueRaw"];
        }
        compensateAcceptedDifferences(a[i], true);
      }
      if (
        typeof i === "string" &&
        i.startsWith("event_arg_") &&
        typeof a[i] === "string" &&
        byteLength(a[i]) >= 100
      ) {
        // This is a heuristic that says:
        // If the column is 100 characters then it was probably truncated and
        // therefore we don't care about it.
        //
        // It is necessary because the null characters in mysql cause the truncation
        // to be different between the harvester and subquery.
        a[i] = expect.anything();
      } else if ((i === "nonce" || i === "extrinsic_hash") && !a[i]) {
        // The harvester has a bunch of empty data in these columns
        a[i] = expect.anything();
      } else if (i === "offchainAccuracy") {
        // As far as I can tell offchainAccuracy is deserialized wrong in the harvester.
        a[i] = expect.anything();
      } else if (typeof a[i] === "string") {
        // Remove null characters because postgresql doesn't support them.
        a[i] = a[i].replace(/\0|\\u0000/g, "");
        // Also parse it if it is paseable.
        try {
          const parsed = JSON.parse(a[i]);
          if (typeof parsed === "object") {
            a[i] = JSON.parse(a[i]);
          }
        } catch {
          //ignore
        }
      } else if (typeof a[i] === "number") {
        // Reduce number precision to allow slight deviation between subquery and harvester.
        // Specifically for "score" in "staking::submit_election_solution_unsigned".
        a[i] = a[i].toPrecision(13);
      } else {
        compensateAcceptedDifferences(a[i], true);
      }
    }
  }
};

/**
 * @returns the index of the block before a block gap
 */
const findMissingBlock = (results: { block_id: number }[]) =>
  findInPairs(results, (a, b) =>
    a.block_id !== b.block_id + 1 ? a.block_id : undefined
  );

enum DB {
  POSTGRES,
  MYSQL,
}
type TableQuery = (
  db: DB
) => (
  qb: QueryBuilder<any>,
  blockStart: number,
  blockEnd: number
) => Promise<any[]>;

const START_BLOCK = parseInt(env.START_BLOCK);
const MAX_BLOCK = parseInt(env.MAX_BLOCK);
const BATCH_SIZE = parseInt(env.BATCH_SIZE);

const compareTable = async (
  q: TableQuery,
  table_name: string,
  mysql: Connection,
  postgres: Connection
) => {
  let hasError = false;

  const errorFileName = `errors_${table_name}`;
  const errorStream = createWriteStream(errorFileName, {
    flags: "w",
  });

  let i = START_BLOCK;
  // eslint-disable-next-line no-constant-condition
  while (true) {
    const blockStart = i;
    const blockEnd = Math.min(i + BATCH_SIZE, MAX_BLOCK);

    const harvester_result = await q(DB.MYSQL)(
      mysql.createQueryBuilder(),
      blockStart,
      blockEnd
    ).then((results) => results.filter((r) => !badDataBlocks.has(r.block_id)));

    const subquery_result = await q(DB.POSTGRES)(
      postgres.createQueryBuilder(),
      blockStart,
      blockEnd
    ).then((results) => results.filter((r) => !badDataBlocks.has(r.block_id)));

    if (harvester_result.length < subquery_result.length) {
      throw new Error(
        `Missing block in harvester ${table_name}: ${findMissingBlock(
          harvester_result
        )}, harvester result length: ${
          harvester_result.length
        }, subquery result length: ${subquery_result.length}`
      );
    }
    if (subquery_result.length < harvester_result.length) {
      throw new Error(
        `Missing block in subquery ${table_name}: ${findMissingBlock(
          subquery_result
        )}, harvester result length: ${
          harvester_result.length
        }, subquery result length: ${subquery_result.length}`
      );
    }

    for (const [s, h] of zip(subquery_result, harvester_result)) {
      if (table_name === "data_block" && badDataBlocks.has(s.block_id)) {
        continue;
      }
      compensateAcceptedDifferences(h);
      compensateAcceptedDifferences(s);
      try {
        expect(h).toEqual(s);
      } catch (e) {
        hasError = true;
        if (
          !errorStream.write(
            `\n--------------------------------------------\n${e.toString()}`
          )
        ) {
          await new Promise((res, rej) =>
            errorStream.once("drain", (error) =>
              error ? rej(error) : res(undefined)
            )
          );
        }
      }
    }

    console.log(
      `Processed blocks (${table_name}) [${blockStart}, ${blockEnd}]`
    );

    if (blockEnd >= MAX_BLOCK) {
      if (hasError) {
        throw new Error(
          `Table: ${table_name} contains errors, check the ${errorFileName} file`
        );
      } else {
        return;
      }
    }
    i = blockEnd;
  }
};

/**
 * @returns an array of length min(a.length,b.length) of pairs of the items at the same
 * index in `a` and `b`.
 */
const zip = <T, K>(a: T[], b: K[]): [T, K][] => a.map((k, i) => [k, b[i]]);

const eventQuery: TableQuery = (db) => async (qb, blockStart, blockEnd) =>
  qb
    .select("block_id")
    .addSelect("event_idx")
    .addSelect("spec_version_id")
    .addSelect("module_id")
    .addSelect("event_id")
    .addSelect("attributes")
    .addSelect("event_arg_0")
    .addSelect("event_arg_1")
    .addSelect("event_arg_2")
    .addSelect("event_arg_3")
    .addSelect("claim_type")
    .addSelect(
      db === DB.MYSQL ? "cast(claim_scope as JSON)" : "claim_scope::json",
      "clam_scope"
    )
    .addSelect("claim_issuer")
    .addSelect("claim_expiry")
    .addSelect("corporate_action_ticker")
    .addSelect("fundraiser_offering_asset")
    .addSelect("transfer_to")
    .from("data_event", "e")
    .where("block_id >= :blockStart AND block_id < :blockEnd", {
      blockStart,
      blockEnd,
    })
    .orderBy("block_id", "ASC")
    .addOrderBy("event_idx", "ASC")
    .getRawMany();

const blockQuery: TableQuery = () => (qb, blockStart, blockEnd) =>
  qb
    .select("id", "block_id")
    .addSelect("parent_id")
    .addSelect("hash")
    .addSelect("parent_hash")
    .addSelect("state_root")
    .addSelect("extrinsics_root")
    .addSelect("count_extrinsics")
    .addSelect("count_extrinsics_unsigned")
    .addSelect("count_extrinsics_signed")
    .addSelect("count_extrinsics_error")
    .addSelect("count_extrinsics_success")
    .addSelect("count_events")
    .addSelect("datetime")
    .addSelect("spec_version_id")
    .from("data_block", "b")
    .where("id >= :blockStart AND id < :blockEnd", {
      blockStart,
      blockEnd,
    })
    .orderBy("block_id", "ASC")
    .getRawMany();

const extrinsicQuery: TableQuery = () => (qb, blockStart, blockEnd) =>
  qb
    .select("block_id")
    .addSelect("extrinsic_idx")
    .addSelect("signed")
    .addSelect("call_id")
    .addSelect("module_id")
    .addSelect("nonce")
    .addSelect("extrinsic_hash")
    .addSelect("params")
    .addSelect("success")
    .addSelect("address")
    .addSelect("signedby_address")
    .addSelect("spec_version_id")
    .from("data_extrinsic", "e")
    .where("block_id >= :blockStart AND block_id < :blockEnd", {
      blockStart,
      blockEnd,
    })
    .orderBy("block_id", "ASC")
    .addOrderBy("extrinsic_idx", "ASC")
    .getRawMany();

const main = async () => {
  const table = process.env.TABLE;

  const postgres = await createConnection({
    type: "postgres",
    host: env.PG_HOST,
    port: parseInt(env.PG_PORT),
    username: env.PG_USER,
    password: env.PG_PASSWORD,
    database: env.PG_DATABASE,
    name: "postgres",
  });
  const mysql = await createConnection({
    type: "mysql",
    host: env.MYSQL_HOST,
    port: parseInt(env.MYSQL_PORT),
    username: env.MYSQL_USER,
    password: env.MYSQL_PASSWORD,
    database: env.MYSQL_DATABASE,
    name: "mysql",
  });

  switch (table) {
    case "data_event":
      return await compareTable(eventQuery, "data_event", mysql, postgres);
    case "data_block":
      return await compareTable(blockQuery, "data_block", mysql, postgres);
    case "data_extrinsic":
      return await compareTable(
        extrinsicQuery,
        "data_extrinsic",
        mysql,
        postgres
      );
    default:
      throw new Error(`Unknown table: ${table}`);
  }
};

main()
  .then(() => process.exit(0))
  .catch((e) => {
    console.log(e);
    process.exit(1);
  });
